# –û—Å–Ω–æ–≤—ã –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ .NET

> ü•§ *–ú–∞—Ç–µ—Ä–∏–∞–ª –Ω–∞—á–∞–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏*

–≠—Ç–∞ –≥–ª–∞–≤–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤—Å–µ–º –±–∞–∑–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤–º–µ—Å—Ç–µ —Å —Ç–µ–º —Å—Ä–∞–∑—É –ø–æ–≥—Ä—É–∂–∞–µ—Ç –≤ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å –ª—É—á—à–µ? –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ, –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ –∏–ª–∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ, –Ω–æ –Ω–∞ ThreadPool?". –û—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –º–æ–∂–µ—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º, –æ–¥–Ω–∞–∫–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –∏–Ω–∞—è: –≤—Å—ë –∫–∞–∫ –∏ –≤–µ–∑–¥–µ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏: –æ—Ç —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏, –æ—Ç –µ—ë —Ä–∞–∑–º–µ—Ä–∞, –æ—Ç –ø—Ä–æ—á–∏—Ö —É—Å–ª–æ–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ –≤ –≥–æ–ª–æ–≤—É —Å–∞–º–∏ —Å–æ–±–æ–π –Ω–µ –ø—Ä–∏–¥—É—Ç.

–ê –ø–æ—Ç–æ–º—É –º—ã –ø—Ä–æ–π–¥—ë–º—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø–æ IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏—è–º, —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ç–æ–∫–∞, –±–∞–∑–æ–≤—ã–º –æ—Å–Ω–æ–≤–∞–º —Ä–∞–±–æ—Ç—ã –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ (–Ω–æ —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤—ã), –∞ –¥–∞–ª–µ–µ -- —É–≥–ª—É–±–∏–º—Å—è –≤ –∞–Ω–∞–ª–∏–∑ —á—ë—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞: –æ—Ç —á–µ–≥–æ –∑–∞–≤–∏—Å–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤? –ö–∞–∫–æ–≤ –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–µ–º–ª–∏–º –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤ –Ω–µ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å? 

–ó–∞–∫–æ–Ω—á–∏–º –º—ã –≥–ª–∞–≤—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—É–≥–∞—é—â–∏–º–∏ –≤—ã–≤–æ–¥–∞–º–∏ –æ–± –æ–±—ä–µ–º–∞—Ö —Ä–∞–±–æ—Ç—ã, –ø—Ä–∏–µ–º–ª–∏–º–æ–π –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –ø—É–ª–µ –ø–æ—Ç–æ–∫–æ–≤.

## –ü–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –Ω–∞—á–∞—Ç—å

–ì–ª–∞–≤—É –æ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ç–æ–∏—Ç –Ω–∞—á–∞—Ç—å —Å –º—ã—Å–ª–µ–π –æ —Ç–æ–º, —á—Ç–æ –≤—Å—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö –ø–æ—Ç–æ–∫–æ–≤ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ .NET –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤ .NET –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö —Å–≤–æ–∏—Ö, —Ç–æ–Ω–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤. –ó–∞—Ç–æ –µ—Å—Ç—å –æ–±—ë—Ä—Ç–∫–∏ –Ω–∞–¥ –ø–æ—Ç–æ–∫–∞–º–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –Ω–∞–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –∫–æ—Ä–Ω—è–º–∏ —É—Ö–æ–¥—è—Ç –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É.

–í –æ–±—â–µ–º –ø–æ—Ç–æ–º—É-—Ç–æ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—á–∏–Ω–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å —É—Ä–æ–≤–Ω—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∏–Ω–∞—á–µ –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö —Ä–∞–±–æ—Ç—ã –ø–æ—Ç–æ–∫–æ–≤. –î–ª—è –æ–±—ã—á–Ω–æ–≥–æ, —Ä–∞–∑–∞–±–æ—Ç—á–∏–∫–∞ –≤ —Å—Ñ–µ—Ä–µ .NET –ø–æ—Ç–æ–∫–∏ -- —ç—Ç–æ —Å–∫–æ—Ä–µ–µ –Ω–µ—è—Å–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è —á–µ–º —á—Ç–æ-—Ç–æ –ø–æ–Ω—è—Ç–Ω–æ–µ. –ê –ø–æ—Ç–æ–º—É -- –Ω–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ —Ç–∞–∫–æ–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞. –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è —è–¥—Ä–∞ –∏ —á–µ–º –æ–Ω–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è.

–ê –ø–æ—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã –Ω–∞—á–∞–ª–∏ —Å —ç—Ç–æ–π –≥–ª–∞–≤—ã, –≤–µ—Ä–Ω–∏—Ç–µ—Å—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–∑–∞–¥. –í –ø—Ä–µ–¥—É–¥—É—â–∏—Ö –≥–ª–∞–≤–∞—Ö –æ–ø–∏—Å–∞–Ω—ã –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–µ –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–≤–µ–¥—É—Ç –≤–∞—à–∏ –∑–Ω–∞–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (–∞ –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º–∏ -- –∏ —É—Ä–æ–≤–µ–Ω—å –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞).

## Thread

–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–æ—Ç–æ–∫? –ü—Ä–æ–≥–æ–≤–æ—Ä–∏–º –µ—â—ë —Ä–∞–∑. –≠—Ç–æ –Ω–µ–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –∏—Å–ø–æ–ª–Ω—è–µ—Ç –µ–¥–∏–Ω—ã–º *–ø–æ—Ç–æ–∫–æ–º* –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ª–∏–±–æ –ø—Å–µ–≤–¥–æ–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥–∏—Ö *–ø–æ—Ç–æ–∫–æ–≤* –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ -- –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–¥ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —è–¥—Ä–∞—Ö. –ü—Å–µ–≤–¥–æ–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ -- –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–¥ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —è–¥—Ä–µ. –ê –ø–æ—Ç–æ–º—É -- —á—Ç–æ–±—ã —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å –≤ –≥–ª–∞–∑–∞—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–Ω–∏ –±—å—é—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –∏ —á–µ—Ä–µ–¥—É—Ç—Å—è, —Å–æ–∑–¥–∞–≤–∞—è –∏–ª–ª—é–∑–∏—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: —ç—Ç–æ –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å —Ü–≤–µ—Ç–Ω–æ–π –ø–µ—á–∞—Ç—å—é. –ï—Å–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –ø–æ–ª–Ω–æ—Ü–≤–µ—Ç–Ω—É—é –ø–µ—á–∞—Ç—å –ø–æ–¥ –ª—É–ø–æ–π (–∏–ª–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–∞–º–µ—Ä—ã —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞), –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å –º–∏–∫—Ä–æ—Ç–æ—á–∫–∏ CMYK (Cyan, Magneta, Yellow, Key). –ò—Ö –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏, –Ω–æ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ–Ω–∏ –æ–±—Ä–∞–∑—É—é—Ç –µ–¥–∏–Ω–æ–µ –ø—è—Ç–Ω–æ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞.

–î–æ–±–∏—Ç—å—Å—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–≤–ª–∞–¥–µ—Ç—å —è–¥—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –º–æ–Ω–æ–ø–æ–ª—å–Ω–æ –≤ .NET –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –î–∞ –∏ –≤ –û–° –Ω–µ—Ç —Ç–∞–∫–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –ê —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ª—é–±–æ–π –≤–∞—à –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –ø—Ä–µ—Ä–≤–∞–Ω –≤ –∞–±—Å–æ–ª—é—Ç–Ω–æ –ª—é–±–æ–º –º–µ—Å—Ç–µ: –¥–∞–∂–µ –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ `a = b;`, –∫–æ–≥–¥–∞ `b` —Å—á–∏—Ç–∞–ª–∏, –∞ `a` –µ—â—ë –Ω–µ –∑–∞–ø–∏—Å–∞–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –ø–æ–º–∏–º–æ –≤–∞—Å –Ω–∞ —Ç–æ–º –∂–µ —è—Ä–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—â—ë –∫—Ç–æ-—Ç–æ. –ò —Å –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–µ—Ä–≤–∞–Ω—ã –≤—ã –±—É–¥–µ—Ç–µ –Ω–∞ –±–æ–ª–µ–µ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ä–æ–∫ –Ω–µ–∂–µ–ª–∏ –≤–∞–º –æ—Ç–ø—É—â–µ–Ω–æ –Ω–∞ —Ä–∞–±–æ—Ç—É: –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ –ø–æ–º–∏–º–æ –≤–∞—Å –Ω–∞ —è–¥—Ä–µ –∏—Ö –±—É–¥–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ. –ê –∑–Ω–∞—á–∏—Ç –≤—ã –±—É–¥–µ—Ç–µ –ø–æ —á—É—Ç—å-—á—É—Ç—å –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –æ—á–µ—Ä–µ–¥–∏. –°–Ω–∞—á–∞–ª–∞ –≤—ã, –ø–æ—Ç–æ–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º -- —Å–Ω–æ–≤–∞ –≤—ã.

–û–¥–Ω–∞–∫–æ, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ -- —ç—Ç–æ –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –í–µ–¥—å —á—Ç–æ —Ç–∞–∫–æ–µ "—Å–æ–∑–¥–∞—Ç—å –ø–æ—Ç–æ–∫"? –î–ª—è –Ω–∞—á–∞–ª–∞ —ç—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É. –û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É -- —ç—Ç–æ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ –±–∞—Ä—å–µ—Ä–∞ –º–µ–∂–¥—É —Å–ª–æ–µ–º –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ –ü–û –∏ —Å–ª–æ–µ–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –°–ª–æ–∏ —ç—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º, –∞ —Å—Ç–æ—Ä–æ–Ω—ã –±–∞—Ä—å–µ—Ä–æ–≤ - *–∫–æ–ª—å—Ü–∞–º–∏ –∑–∞—â–∏—Ç—ã*. –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏–º–µ–µ—Ç –∫–æ–ª—å—Ü–æ –∑–∞—â–∏—Ç—ã `Ring 3`, —Ç–æ–≥–¥–∞ –∫–∞–∫ —É—Ä–æ–≤–µ–Ω—å –û–° –∑–∞–Ω–∏–º–∞–µ—Ç –∫–æ–ª—å—Ü–æ `Ring 0`. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –∏–∑ –∫–æ–ª—å—Ü–∞ –≤ –∫–æ–ª—å—Ü–æ -- –æ–ø–µ—Ä–∞—Ü–∏—è –¥–æ—Ä–æ–≥–∞—è, –∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Ç–µ–º –¥–≤–∞: –∏–∑ `Ring 3` –≤ `Ring 0` –∏ –æ–±—Ä–∞—Ç–Ω–æ. –ü–ª—é—Å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–µ–∫–æ–≤ –ø–æ—Ç–æ–∫–∞: –æ–¥–∏–Ω –¥–ª—è `Ring 3`, –≤—Ç–æ—Ä–æ–π -- –¥–ª—è `Ring 0`. –ü–ª—é—Å —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã .NET. –í –æ–±—â–µ–º —á—Ç–æ–±—ã —á—Ç–æ-—Ç–æ –∏—Å–ø–æ–ª–Ω–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–µ–º—É-—Ç–æ *–±—ã—Å—Ç—Ä–æ*, –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–¥—ë—Ç—Å—è –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. 

–û–¥–Ω–∞–∫–æ –ª—é–¥–∏ –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—ã –∏—Å–ø–æ–ª–Ω—è–ª–∏—Å—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ, –Ω–µ —É—Ö–æ–¥—è –≤ –æ–∂–∏–¥–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –º–∞–ª–æ. –°–∫–æ—Ä–µ–µ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
1. *–û–∂–∏–¥–∞–Ω–∏–µ —Å–µ—Ç–∏ –ø–æ –≤–æ–ø—Ä–æ—Å—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞*
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–ø—Ä–æ—Å, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–ø—Ä–æ—Å –∫ –ë–î, –æ—Ç–ø—Ä–∞–≤–∏–ª–∏
3. *–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ë–î*
4. –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω, –ø–µ—Ä–µ–≤–µ–ª–∏ –≤ –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–∏—Å–∞
5. *–û—Ç–ø—Ä–∞–≤–∏–ª–∏ –æ—Ç–≤–µ—Ç*

–ò –ø—É–Ω–∫—Ç—ã (2) –∏ (4) -- –Ω–µ —Ç–∞–∫ –¥–æ–ª–≥–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è. –°–∫–æ—Ä–µ–µ —ç—Ç–æ -- –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —É—á–∞—Å—Ç–∫–∏ –∫–æ–¥–∞. –ê –ø–æ—Ç–æ–º—É —Å—Ç–æ–∏—Ç –∑–∞–¥–∞—Ç—å—Å—è –≤–æ–ø—Ä–æ—Å–æ–º: –¥–ª—è —á–µ–≥–æ –ø–æ–¥ –Ω–∏—Ö —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ (—Ç—É—Ç –æ—Ç—Å—ã–ª–∫–∞ –∫ –Ω–µ–≤–µ—Ä–Ω–æ–º—É –º–Ω–æ–≥–∏–º–∏ —Ç—Ä–∞–∫—Ç–æ–≤–∞–Ω–∏–∏ —Å–ª–æ–≤–∞ *–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ* –∏ –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ —á—Ç–æ-—Ç–æ –æ—Ç—Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)? –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ —Ü–µ–ø–æ—á–∫–∞ (1) - (5) —Ä–∞–±–æ—Ç–∞–µ—Ç —Ü–µ–ª–∏–∫–æ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤ —Ç–æ—á–∫–∞—Ö (1), (3) –∏ (5) –ø–æ—Ç–æ–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –æ–∂–∏–¥–∞–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, —Ç.–∫. –∂–¥—ë—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ä—Ç—ã. –¢.–µ. –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ –Ω–∏–∫–∞–∫ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –µ—ë –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –¢–æ–≥–¥–∞ —á—Ç–æ, web-—Å–µ—Ä–≤–µ—Ä—É –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ç–æ–∫ –ø–æ–¥ –≤—Å—é —Ü–µ–ø–æ—á–∫—É? –ê –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 1000 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É? –ú—ã –∂–µ –ø–æ–º–Ω–∏–º, —á—Ç–æ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∫—Ä–∞–π–Ω–µ –¥–æ–ª–≥–æ. –ó–Ω–∞—á–∏—Ç –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–∫–∏–º–∏ —Å–∫–æ—Ä–æ—Å—Ç—è–º–∏ –µ—Å–ª–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–¥ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ—Ç–æ–∫. –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö? *–ë—Ä–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –≤ –∞—Ä–µ–Ω–¥—É?*

## ThreadPool

–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –∏ –≤–æ–∑–Ω–∏–∫ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤, ThreadPool. –û–Ω —Ä–µ—à–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á:
- —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –æ–Ω –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞: –º—ã —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –Ω–µ –¥–æ–ª–∂–Ω—ã
- —Å–æ–∑–¥–∞–≤ –∫–æ–≥–¥–∞-—Ç–æ –ø–æ—Ç–æ–∫, –æ–Ω –∏—Å–ø–æ–ª–Ω—è–µ—Ç –Ω–∞ –Ω—ë–º —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏. –í–∞–º –∂–µ –Ω–µ –≤–∞–∂–Ω–æ, –Ω–∞ –∫–∞–∫–æ–º –∏–∑ –Ω–∏—Ö –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è? –ì–ª–∞–≤–Ω–æ–µ —á—Ç–æ–±—ã –±—ã–ª
    - –∞ –ø–æ—Ç–æ–º—É –º—ã –±–æ–ª–µ–µ –Ω–µ —Ç—Ä–∞—Ç–∏–º –≤—Ä–µ–º—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –û–°: –º—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö
    - –∞ –ø–æ—Ç–æ–º—É –Ω–∞–≥—Ä—É–∂–∞—è ThreadPool —Å–≤–æ–∏–º–∏ –¥–µ–ª–µ–≥–∞—Ç–∞–º–∏ –º—ã –º–æ–∂–µ–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —è–¥—Ä–∞ CPU —Ä–∞–±–æ—Ç–æ–π
- –ª–∏–±–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ª–∏–±–æ –Ω–∞–æ–±–æ—Ä–æ—Ç: –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –≤—Å–µ 100% –æ—Ç –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —è–¥–µ—Ä.

–û–¥–Ω–∞–∫–æ, –∫–∞–∫ –º—ã —É–±–µ–¥–∏–º—Å—è –ø–æ–∑–∂–µ —É –ª—é–±–æ–π —Ç–∞–∫–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –µ—Å—Ç—å –º–∞—Å—Å–∞ –Ω—é–∞–Ω—Å–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–∞ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ –∏ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π —Å–µ—Ä—ä—ë–∑–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. –ü—É–ª –ø–æ—Ç–æ–∫–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö, –∞ –≤–æ –º–Ω–æ–≥–∏—Ö –æ–Ω —Å—Ç–∞–Ω–µ—Ç —Å–µ—Ä—å—ë–∑–Ω—ã–º "–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª–µ–º" –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –û–¥–Ω–∞–∫–æ –¥–∞–≤–∞–π—Ç–µ –≤–∑–≥–ª—è–Ω–µ–º –Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—é –ø–æ–¥ –¥—Ä—É–≥–∏–º —É–≥–ª–æ–º. –ó–∞—á–∞—Å—Ç—É—é –ø—Ä–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏ –∫–∞–∫–æ–π-–ª–∏–±–æ —Ç–µ–º—ã –∞–≤—Ç–æ—Ä–æ–º –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –Ω–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è "–∑–∞—á–µ–º": –∫–∞–∫ –±—É–¥—Ç–æ –∏ —Ç–∞–∫ –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ. –ú—ã –∂–µ –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–π—Ç–∏ –¥—Ä—É–≥–∏–º –ø—É—Ç—ë–º. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–Ω—è—Ç—å ThreadPool. 

–ò –µ—Å–ª–∏ –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å —Å —Ç–æ–π —Å—Ç–æ—Ä–æ–Ω—ã —á—Ç–æ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ -- —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ç–æ –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å: –∫–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –¥–æ–ª–∂–µ–Ω —Ä–µ—à–∞—Ç—å —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç? 

### –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —É–ø—Ä–æ—â–µ–Ω–∏—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞

–£–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º - –∑–∞–¥–∞—á–∞ –Ω–µ –∏–∑ –ø—Ä–æ—Å—Ç—ã—Ö. –í–µ—Ä–Ω–µ–µ, –∫–æ–Ω–µ—á–Ω–æ –∂–µ, —ç—Ç–æ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.... –ù–æ –∫–æ–≥–¥–∞ —É –≤–∞—Å "–Ω–∏—á–µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ" –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –∏ –≥–Ω–∞—Ç—å —á–µ—Ä–µ–∑ –Ω–∏—Ö –ø–æ—Ç–æ–∫ –∑–∞–¥–∞—á —Å—Ç–∞–Ω–µ—Ç –ø–µ—Ä–µ—É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ–º. –¢–µ–º –±–æ–ª–µ–µ —á—Ç–æ —ç—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä—É—Ç–∏–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –ü–æ—ç—Ç–æ–º—É –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∫–ª–∞—Å—Å–æ–≤ –≤—ã–≥–ª—è–¥–∏—Ç –∫—Ä–∞–π–Ω–µ –ª–æ–≥–∏—á–Ω–æ.

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ Microsoft —Å–¥–µ–ª–∞–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ -- —á—Ç–æ —Å–¥–µ–ª–∞–ª–∞ ThreadPool —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–ª–∞—Å—Å–æ–º –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é. –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞–ª–æ —Ü–µ–ª—ã–π –ø–ª–∞—Å—Ç –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è –º–µ–∂–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º runtime –∏ –∫–æ–Ω–µ—á–Ω—ã–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –ø–æ—Ç–æ–º—É –∫–∞–∫ —É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –æ—â—É—â–µ–Ω–∏—è, —á—Ç–æ –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–≤–æ–∏ –ø—É–ª—ã –ø–æ—Ç–æ–∫–æ–≤ –∏ —á—Ç–æ –∏–º–∏ –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ß—Ç–æ –µ—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –Ω–∞–¥ –ø—É–ª–∞–º–∏ –ø–æ—Ç–æ–∫–æ–≤, –æ—Ç–¥–∞–≤–∞—è –∫–æ—Ç–æ—Ä—ã–µ –≤–æ –≤–Ω–µ—à–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤—ã –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç–µ –∏—Ö –∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º, –æ–±—â–∏–º –ø—É–ª–æ–º.

–ù–æ –µ—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç—å –≥–ª–∞–∑–∞ –Ω–∞ —ç—Ç–∏ –Ω–µ–¥–æ—á—ë—Ç—ã (–∫ –∫–æ—Ç–æ—Ä—ã–º –º—ã –≤–µ—Ä–Ω—ë–º—Å—è –ø–æ–∑–∂–µ), —Ç–æ —Å —Ç–æ—á–∫–∏ —É–ø—Ä–æ—â–µ–Ω–∏—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞, –∫–æ–Ω–µ—á–Ω–æ, –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ -- –∏–¥–µ–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –í–µ–¥—å –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª–Ω—è—é—â–∏–π—Å—è –∫–æ–¥ -- –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–º —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –≤–∞–∂–µ–Ω –ø–æ—Ç–æ–∫, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç. –ò–º –≤–∞–∂–Ω–æ –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥—É. –í–∞–º –¥–∞–∂–µ –Ω–µ —Ç–∞–∫ –≤–∞–∂–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ. –í–∞–º –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã CPU —Ä–∞—Å—Ö–æ–¥–æ–≤–∞–ª—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ. 

>{.big-quote} –ü–æ–∫–∞ –º—ã –±—É–¥–µ–º —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å ThreadPool –∫–∞–∫ *–∏–¥–µ–∞–ª—å–Ω—ã–π* –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –±–µ–∑ –≤—Å—è–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç –∑–∞–¥–∞—á—É –∏–∑ –æ–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ –¥—Ä—É–≥–æ–π

### –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π

–ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ —Å–æ–∑–¥–∞–Ω —á—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–∏. –ò —á–∞—Å—Ç–∏—á–Ω–æ —ç—Ç–æ —Ç–∞–∫. –Ø –±—ã —Å–∫–∞–∑–∞–ª, —á—Ç–æ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π *–≤—Ç–æ—Ä–æ–≥–æ —É—Ä–æ–≤–Ω—è*. –í —Ç–æ–º —Å–º—ã—Å–ª–µ, —á—Ç–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –±–µ–∑ –Ω–µ–≥–æ –∏ –æ–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ, –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. 

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã "–Ω–∞–π—Ç–∏" –ø–µ—Ä–≤—ã–π —Å–ª–æ–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Ç–æ–∫–∏. –ü–æ—Ç–æ–∫–∏ -- —ç—Ç–æ —Å–ª–æ–π –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –æ –ø–æ—Ç–æ–∫–∞—Ö –Ω–µ –∑–Ω–∞–µ—Ç –Ω–∏—á–µ–≥–æ, –æ –Ω–∏—Ö –∑–Ω–∞–µ—Ç —Ç–æ–ª—å–∫–æ –û–° –∏ –≤—Å—ë, —á—Ç–æ –Ω–∞ –Ω–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü–ª—é—Å –∫ —ç—Ç–æ–º—É —Å—É—â–µ—Å—Ç–≤—É—é—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ—á–µ–º—É-—Ç–æ –≤—Å–µ –±–æ—è—Ç—Å—è (—Å–ø–æ–π–ª–µ—Ä: –∑—Ä—è). –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ -- —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –æ–∂–∏–¥–∞–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —á—Ç–æ —á—Ç–æ-—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ –æ—Ç–ø—É—Å—Ç–∏–ª–∏ —Å–µ–º–∞—Ñ–æ—Ä –∏–ª–∏ —á—Ç–æ –æ—Ç–ø—É—Å—Ç–∏–ª–∏ –º—å—é—Ç–µ–∫—Å. –ù–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –ª–∏ —Å–ø–∏—Å–æ–∫ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–∏–º–∏—Ç–∏–≤–∞–º–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏? –ò—Å—Ö–æ–¥—è –∏–∑ –∑–Ω–∞–Ω–∏–π —Ä—è–¥–æ–≤–æ–≥–æ .NET —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –¥–∞. –ù–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –Ω–µ —Ç–∞–∫. 

–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ –º—å—é—Ç–µ–∫—Å–∞, –ø—Ä–∏–≤–æ–¥—è—â–∏–π –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –õ—é–±–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–Ω–∏—é –≤ –±–æ–ª–µ–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª—å—Ü–æ –∑–∞—â–∏—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (`Ring 0` –¥–ª—è Windows –∏ `Ring 2` –≤ Linux), –∏–ª–∏ –≥–æ–≤–æ—Ä—è —è–∑—ã–∫–æ–º –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –≤ kernel space. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–Ω–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä—è–¥ –æ–ø–µ—Ä–∞—Ü–∏–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö —Å–æ–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö –û–° –æ—Ç —É—Ä–æ–≤–Ω—è –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è. –í—Å–µ —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, —Å—Ç–æ—è—Ç –≤—Ä–µ–º–µ–Ω–∏. –ï—Å–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç—å –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –≤—Ä–µ–º–µ–Ω–∏ —ç—Ç–æ —Å—Ç–æ–∏—Ç –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º—ã—Å–ª–∏—Ç –º–µ–¥–ª–µ–Ω–Ω–æ. –û–¥–Ω–∞–∫–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã —ç—Ç–æ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–º–µ—Ç–Ω–æ. –î–∞–ª–µ–µ, –µ—Å–ª–∏ —Ä–µ—á—å –∏–¥—ë—Ç –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä—è–¥ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–ª–∏ –Ω–µ—Ç, –∏ –µ—Å–ª–∏ –µ—Å—Ç—å, –ø–æ—Ç–æ–∫ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –≤ —Å–ø–∏—Å–æ–∫ –æ–∂–∏–¥–∞–Ω–∏—è —Å–Ω—è—Ç–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç? –ü–æ—Å–∫–æ–ª—å–∫—É –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–µ—Ç—Å—è —Å–ø–∏—Å–∫–æ–º –≥–æ—Ç–æ–≤—ã—Ö –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ—Ç–æ–∫–æ–≤ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ç–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –æ–Ω–∞ –Ω–µ –∑–∞–º–µ—Ç–∏—Ç –∏ –ø–æ—Ç–æ–º—É –Ω–µ —Å—Ç–∞–Ω–µ—Ç —Ç—Ä–∞—Ç–∏—Ç—å –Ω–∞ –Ω–µ–≥–æ —Ä–µ—Å—É—Ä—Å—ã. –ï–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ—Ç –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏. –ê –ø–æ—Ç–æ–º—É –ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –∫–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –≤—Å—Ç–∞—ë—Ç –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –æ–Ω –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–æ—Ç–æ–º—É –µ—Å–ª–∏ –≤—Å–µ –ø–æ—Ç–æ–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ, —É—Ä–æ–≤–µ–Ω—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω 0%.

–û–¥–Ω–∞–∫–æ —Ç–æ–ª—å–∫–æ –ª–∏ –ø—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –æ–±–ª–∞–¥–∞—é—Ç —Ç–∞–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏? –ù–µ—Ç: —Ç–∞–∫–∏–º–∏ –∂–µ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –æ–±–ª–∞–¥–∞–µ—Ç –ø–æ–¥–∞–≤–ª—è—é—â–µ–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ IO-bound –æ–ø–µ—Ä–∞—Ü–∏–π. –î–∞, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –±–µ–∑ IO-bound –æ–ø–µ—Ä–∞—Ü–∏–π. –ü—Ä–æ—Å—Ç—ã–º –ø—Ä–∏–º–µ—Ä–æ–º —Ç–∞–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã: —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–≤ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É, –æ–±—Ä–∞—â–∞—è—Å—å –∫ —Ñ—É–Ω–∫—Ü–∏—è–º BIOS –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (—Ç–µ–∫—Å—Ç–æ–≤—ã–π, –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π VESA –∏ –ø—Ä–æ—á.), –ø–æ–º–∏–º–æ –ø–µ—Ä–µ–≤–æ–¥–∞ —ç–∫—Ä–∞–Ω–∞ –≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ä–µ–∂–∏–º BIOS –¥–æ–ª–∂–µ–Ω —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã —Å –ø—Ä–∏–∫–ª–∞–¥–Ω—ã–º –ü–û. –í —Å–ª—É—á–∞–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ BIOS –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –Ω–∞ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, –Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω 0xB8000 –∏ –¥–∞–ª–µ–µ. –ó–∞–ø–∏—Å–∞–≤ –ø–æ —ç—Ç–æ–º—É –∞–¥—Ä–µ—Å—É –∫–æ–¥ —Å–∏–º–≤–æ–ª–∞ (–∫–æ–Ω–µ—á–Ω–æ –∂–µ, —ç—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ DOS –∏–ª–∏ –µ—Å–ª–∏ –≤—ã —Ä–µ—à–∏—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ—é –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –Ω–æ –Ω–µ –≤ Windows), –≤—ã –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —É–≤–∏–¥–∏—Ç–µ –µ–≥–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –ò —ç—Ç–æ –Ω–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –Ω–∏ –∫ –∫–∞–∫–∏–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º: –∑–∞–ø–∏—Å—å –±—É–¥–µ—Ç –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è.

–û–¥–Ω–∞–∫–æ –≤ —Å–ª—É—á–∞–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ç–µ–≤–∞—è –∫–∞—Ä—Ç–∞, –∂—ë—Å—Ç–∫–∏–π –¥–∏—Å–∫ –∏ –ø—Ä–æ—á–∏–µ) —É –≤–∞—Å –±—É–¥–µ—Ç –æ–¥–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –ø–æ–¥–∞—á—É –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –Ω–æ —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ kernel space) –∏ –≤—Ç–æ—Ä–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ -- –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–æ—Ç–æ–∫–∞ –≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ü—Ä–∏—á–∏–Ω–æ–π —ç—Ç–æ–º—É —Å–ª—É–∂–∏—Ç —Ä–∞–∑–Ω–æ—Å—Ç—å –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, —Å –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ: –ø–æ–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —É—Å–ª–æ–≤–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –∫–∞—Ä—Ç–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –ø–æ—Å—ã–ª–∫—É –ø–∞–∫–µ—Ç–∞ –∏ –¥–∞–ª–µ–µ -- –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤ —Å –æ—Ç–≤–µ—Ç–æ–º –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–º —è–¥—Ä–µ –º–æ–∂–Ω–æ —Å–æ–≤–µ—Ä—à–∏—Ç—å –º–∏–ª–ª–∏–æ–Ω—ã, –º–∏–ª–ª–∏–∞—Ä–¥—ã –æ–ø–µ—Ä–∞—Ü–∏–π. –ê –ø–æ—Ç–æ–º—É –ø–æ–∫–∞ –∏–¥—ë—Ç –æ—Ç–≤–µ—Ç –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –º–Ω–æ–≥–æ —á–µ–≥–æ –µ—â—ë –∏ —á—Ç–æ–±—ã —ç—Ç–æ–≥–æ –¥–æ–±–∏—Ç—å—Å—è –ø–æ—Ç–æ–∫ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –∏–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–≤ –¥—Ä—É–≥–∏–º –ø–æ—Ç–æ–∫–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.

–ü–æ —Å—É—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π. –ù–æ —Ä–µ—à–∞–µ—Ç –ª–∏ –æ–Ω –≤—Å–µ –∑–∞–¥–∞—á–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è?

–ö–∞–∂–¥–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è IO-bound –∫–æ–¥–∞. –¢.–µ., –∫–æ–Ω–µ—á–Ω–æ –∂–µ? –æ–ø–µ—Ä–∞—Ü–∏–∏ IO-bound –∏ CPU-bound –∏–¥—É—Ç –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å, –Ω–æ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∫–æ–≥–¥–∞ –Ω–µ–∫–∏–π –ø–æ—Ç–æ–∫ —É—Ö–æ–¥–∏—Ç –≤ –æ–∂–∏–¥–∞–Ω–∏–µ, –æ–Ω –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–µ–Ω—å—à–µ –∑–∞–¥–µ–π—Å—Ç–≤—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, —Ç.–∫. —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π –º—ã *—Ç–µ—Ä—è–µ–º* –ø–æ—Ç–æ–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è. –ò —É–∂–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ –Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ –∑–∞–Ω—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —á–µ–º-—Ç–æ –µ—â—ë. –ß—Ç–æ–±—ã —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, –º–æ–∂–Ω–æ –Ω–∞—Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Ç–æ–∫–æ–≤ –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –Ω–∏—Ö –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å, –æ–¥–Ω–∞–∫–æ —ç—Ç–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç—è–∂–∫–∏–º –∑–∞–Ω—è—Ç–∏–µ–º –∏ –ø–æ—Ç–æ–º—É –±—ã–ª –ø—Ä–∏–¥—É–º–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ü–µ–ø—Ç. –°–æ–∑–¥–∞—ë—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏–º—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏. –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤, –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–æ—Ç–æ–∫—É –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—É–ª—É –ø–æ—Ç–æ–∫–æ–≤ –∑–∞–¥–∞—á –∏ –∏—Å–ø–æ–ª–Ω—è–µ—Ç –∏—Ö. –ö–∞–∫—É—é –∑–∞–¥–∞—á—É —ç—Ç–æ —Ä–µ—à–∞–µ—Ç: –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω —Ç–∞–∫, —á—Ç–æ –æ–Ω, –ø–æ–Ω—è—Ç–Ω–æ –¥–µ–ª–æ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫—É—Å–æ—á–∫–∞–º–∏. –ö—É—Å–æ—á–µ–∫ –∏—Å–ø–æ–ª–Ω–∏–ª—Å—è, –∂–¥—ë–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –í—Ç–æ—Ä–æ–π –∫—É—Å–æ—á–µ–∫ –∏—Å–ø–æ–ª–Ω–∏–ª—Å—è, –∂–¥—ë–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –ò —Ç–∞–∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ. –ü—Ä–∏—á–µ–º –Ω–µ—Ç –∂–µ –Ω–∏–∫–∞–∫–æ–π —Ä–∞–∑–Ω–∏—Ü—ã, –Ω–∞ –∫–∞–∫–æ–º –ø–æ—Ç–æ–∫–µ –∏—Å–ø–æ–ª–Ω—è—Ç—å –≤–æ—Ç —Ç–∞–∫–∏–µ –∫—É—Å–æ—á–∫–∏, –≤–µ—Ä–Ω–æ? –ê –∑–Ω–∞—á–∏—Ç –∏—Ö –º–æ–∂–Ω–æ –æ—Ç–¥–∞–≤–∞—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É–ª—É –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Ö —Ä–∞–∑–±–∏—Ä–∞—Ç—å –∏ –∏—Å–ø–æ–ª–Ω—è—Ç—å. 

–ù–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞: –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø–æ—Ç–æ–∫–µ, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª —ç—Ç–æ –æ–∂–∏–¥–∞–Ω–∏–µ. –¢.–µ. –µ—Å–ª–∏ –º—ã –±—É–¥–µ–º –æ–∂–∏–¥–∞—Ç—å –≤ –ø—É–ª–µ –ø–æ—Ç–æ–∫–æ–≤, –º—ã —Å–Ω–∏–∑–∏–º –µ–≥–æ —É—Ä–æ–≤–µ–Ω—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞. –ö–∞–∫ —ç—Ç–æ —Ä–µ—à–∏—Ç—å? –ò–Ω–∂–µ–Ω–µ—Ä—ã –∏–∑ Microsoft —Å–æ–∑–¥–∞–ª–∏ –¥–ª—è —ç—Ç–∏—Ö —Ü–µ–ª–µ–π –≤–Ω—É—Ç—Ä–∏ ThreadPool –≤—Ç–æ—Ä–æ–π –ø—É–ª: –ø—É–ª –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤. –ò –∫–æ–≥–¥–∞ –Ω–µ–∫–∏–π –∫–æ–¥, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—É–ª–µ —Ä–µ—à–∞–µ—Ç—Å—è –≤—Å—Ç–∞—Ç—å –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, —Å–¥–µ–ª–∞—Ç—å –æ–Ω —ç—Ç–æ –¥–æ–ª–∂–µ–Ω –Ω–µ —Ç—É—Ç –∂–µ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—É–ª–µ, –∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º: –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–≤—à–∏—Å—å –Ω–∞ –≤—Ç–æ—Ä–æ–π –ø—É–ª (–æ–± —ç—Ç–æ–º –ø–æ–∑–∂–µ).

–†–∞–±–æ—Ç–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –¥–µ–ª–µ–≥–∞—Ç–æ–≤ (–¥–∞–≤–∞–π—Ç–µ –Ω–∞–∑—ã–≤–∞—Ç—å –≤–µ—â–∏ —Å–≤–æ–∏–º–∏ –∏–º–µ–Ω–∞–º–∏) –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö, –∞ –æ–∂–∏–¥–∞–Ω–∏–µ - –Ω–∞ –¥—Ä—É–≥–∏—Ö, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è "—Å–ø—è—á–∫–∏" —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è IO-/CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ–≥–¥–∞ —É–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞ –Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è —Ä–∞–±–æ—Ç–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —è–¥–µ—Ä. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã (–Ω–µ—Å–∫–æ–Ω—á–∞–µ–º–æ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—É–ª–µ CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–∞ –≤—Å–µ 100%.

### –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å

–ù–∞ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫—Ä–∞–π–Ω–µ –ø—Ä–æ—Å—Ç–æ. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –æ—á–µ—Ä–µ–¥—å –¥–µ–ª–µ–≥–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–Ω—ã –ø—É–ª—É –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ. –û—á–µ—Ä–µ–¥—å –¥–µ–ª–µ–≥–∞—Ç–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —à–∏—Ä–æ–∫–æ-–∏–∑–≤–µ—Å—Ç–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `ConcurrentQueue`. –î–∞–ª–µ–µ, –∫–æ–≥–¥–∞ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ `ThreadPool.QueueUserWorkItem(() => Console.WriteLine($"Hello from {Thread.CurrentThread.ManagedThreadId}"))`, —Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ—â–∞–µ—Ç–µ –¥–µ–ª–µ–≥–∞—Ç –≤ —ç—Ç—É –æ—á–µ—Ä–µ–¥—å. 

ThreadPool –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Ç—Ä–∏–∫, –æ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –ø–æ–∑–∂–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–æ–≤. –ö–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–∏–∫–ª –≤—ã–±–æ—Ä–∫–∏ –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ: –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏—Ö. –ï—Å–ª–∏ —É–ø—Ä–æ—â–∞—Ç—å, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```csharp
void ThreadMethod()
{

    // ...
    while(needToRun)
    {
        if(_queue.TryDequeue(out var action))
        {
            action();
        }
    }
    // ...
```

–ö–æ–Ω–µ—á–Ω–æ –∂–µ –æ–Ω —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –æ–±—â–∞—è —Å—É—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∞—è.

–û–¥–Ω–∞–∫–æ –ø–æ–º–∏–º–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (—Ç.–Ω. IO-bound –∫–æ–¥) —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–∞–∫–∂–µ –∫–æ–¥, –ø—Ä–∏–≤–æ–¥—è—â–∏–π –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞: –æ–∂–∏–¥–∞–Ω–∏—é –æ—Ç–≤–µ—Ç–∞ –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞, –º—ã—à—å, —Å–µ—Ç—å, –¥–∏—Å–∫ –∏ –ø—Ä–æ—á–∏–µ —Å–∏–≥–Ω–∞–ª—ã –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –≠—Ç–æ—Ç –∫–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è IO-bound. –ï—Å–ª–∏ –º—ã –±—É–¥–µ–º –æ–∂–∏–¥–∞—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø–æ—Ç–æ–∫–∞—Ö –ø—É–ª–∞, —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —á–∞—Å—Ç—å –ø–æ—Ç–æ–∫–æ–≤ –≤ –ø—É–ª–µ –ø–µ—Ä–µ—Å—Ç–µ–Ω—É—Ç –±—ã—Ç—å —Ä–∞–±–æ—á–∏–º–∏ –Ω–∞ –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –≠—Ç–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –∏—Å–ø–æ—Ä—Ç–∏—Ç –ø—É–ª—É –ø–æ—Ç–æ–∫–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —Å—á–∏—Ç–∞–µ—Ç –∏ –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ —ç—Ç–æ–≥–æ –ø—É–ª –Ω–∞—á–Ω—ë—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏–ª—å–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ. –ü–æ–∫–∞ –æ–Ω –ø–æ–π–º—ë—Ç, —á—Ç–æ –µ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ, –ø—Ä–æ–π–¥—ë—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –£ –Ω–µ–≥–æ –ø–æ—è–≤–∏—Ç—Å—è –Ω–µ–∫–∏–π "–ª–∞–≥" –º–µ–∂–¥—É –Ω–∞–≤–∞–ª–∏–≤–∞–Ω–∏–µ–º –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ø—É–ª –∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ–º –∫–æ–¥–∞, —Ä–∞—Å—à–∏—Ä—è—é—â–µ–≥–æ –µ–≥–æ. –ê –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫-—Ç–æ –æ–Ω –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–ª –±—ã –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ.

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å "–∞—Ä–µ–Ω–¥—ã" –ø–æ—Ç–æ–∫–æ–≤, –≤–≤–µ–ª–∏ –≤—Ç–æ—Ä–æ–π –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤. –î–ª—è IO-bound –æ–ø–µ—Ä–∞—Ü–∏–π. –ê –ø–æ—Ç–æ–º—É –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º ThreadPool –¥–≤–∞ –ø—É–ª–∞: –æ–¥–∏–Ω -- –¥–ª—è CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –≤—Ç–æ—Ä–æ–π -- –¥–ª—è IO-bound.

–î–ª—è –Ω–∞—Å —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤ –¥–µ–ª–µ–≥–∞—Ç–µ, —Ä–∞–±–æ—Ç–∞—é—â–µ–º –≤ ThreadPool –≤—Å—Ç–∞–≤–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –Ω–µ–ª—å–∑—è. –û–Ω –¥–ª—è —ç—Ç–æ–≥–æ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

{.wide}
```csharp
ThreadPool.QueueuserWorkItem(
    _ => {

        // ... 1

        // 2
        ThreadPool.RegisterWaitForSingleObject(
            waitObject,    // –æ–±—ä–µ–∫—Ç –æ–∂–∏–¥–∞–Ω–∏—è
            (state) => Console.WriteLine($"Hello from {Thread.CurrentThread.ManagedThreadId}"),  // 3
            null,          // –æ–±—ä–µ–∫—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –¥–µ–ª–µ–≥–∞—Ç (state)
            0,             // timeout –æ–∂–∏–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (0 = –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ)
            true);         // –∂–¥–∞—Ç—å –ª–∏ –µ—â—ë —Ä–∞–∑ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ waitObject 
                           // (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ waitObject == AutoResetEvent)

        // ... 4

    }, null);
);
```

[>]: –¢—É—Ç –∫–æ–Ω–µ—á–Ω–æ –∂–µ —Å—Ç–æ–∏—Ç –ø–æ–º–Ω–∏—Ç—å –æ —Ç–æ–º, —á—Ç–æ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å—Ä–∞–±–æ—Ç–∞–µ—Ç *–ø–æ—Å–ª–µ* RegisterWaitForSingleObject –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—É—á—à–µ–º —Å–ª—É—á–∞–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –¥–µ–ª–µ–≥–∞—Ç–æ–º, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º –≤ RegisterWaitForSingleObject, –∞ –±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ - –ø–µ—Ä–≤–µ–µ –¥–µ–ª–µ–≥–∞—Ç–∞, –Ω–æ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ -- –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ. (1), (2), (3), (4) –Ω–µ –±—É–¥—É—Ç –≤—ã–∑–≤–∞–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –±—É–¥—É—Ç –≤—ã–∑–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ (1), (2) –∏ (4). –ê (3) - –ª–∏–±–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å (4) –ª–∏–±–æ –ø–æ—Å–ª–µ. 

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤—Ç–æ—Ä–æ–π –¥–µ–ª–µ–≥–∞—Ç —É–π–¥—ë—Ç –Ω–∞ –≤—Ç–æ—Ä–æ–π –ø—É–ª IO-bound –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ CPU-bound –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤.

### –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –¥–µ–ª–µ–≥–∞—Ç–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤

–ö–∞–∫–∏–º –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤? –í–µ–¥—å —Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–∂–Ω–æ –∫–∞–∫ –Ω–∞ –¥–≤—É—Ö, —Ç–∞–∫ –∏ –Ω–∞ 1000 –ø–æ—Ç–æ–∫–∞—Ö. –û—Ç —á–µ–≥–æ —ç—Ç–æ –∑–∞–≤–∏—Å–∏—Ç?

–ü—É—Å—Ç—å —É –≤–∞—Å –µ—Å—Ç—å —Ä—è–¥ CPU-bound –¥–µ–ª–µ–≥–∞—Ç–æ–≤. –ù—É, –¥–ª—è –≤–µ—Å–æ–º–æ—Å—Ç–∏ –∏—Ö –ø—É—Å—Ç—å –±—É–¥–µ—Ç –º–∏–ª–ª–∏–æ–Ω. –ù—É –∏ –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å: –Ω–∞ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ—Ç–æ–∫–æ–≤ –∏—Ö –≤—ã—Ä–∞–±–æ—Ç–∫–∞ –±—É–¥–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ–π?

1. –ü—É—Å—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥–æ–≥–æ –¥–µ–ª–µ–≥–∞—Ç–∞ –∑–∞–º–µ—Ç–Ω–∞: –Ω–∞–ø—Ä–∏–º–µ—Ä, 100 –º—Å. –¢–æ–≥–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ç–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —è–¥–µ—Ä, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –∏–¥—ë—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å—Ç—É–ø–∏–º –∫–∞–∫ —Ñ–∏–∑–∏–∫–∏ –∏ –≤–æ–∑—å–º—ë–º –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–¥–µ–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –≥–¥–µ –∫—Ä–æ–º–µ –Ω–∞—Å -- –Ω–∏–∫–æ–≥–æ –Ω–µ—Ç: –Ω–∏ –ø–æ—Ç–æ–∫–æ–≤ –û–° –Ω–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –¢–æ–ª—å–∫–æ –º—ã –∏ CPU. –ù—É –∏ –≤–æ–∑—å–º—ë–º –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ 2-—Ö —è–¥–µ—Ä–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä. –í–æ —Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Ä–∞–±–æ—Ç–∞—Ç—å CPU-bound –∫–æ–¥—É –Ω–∞ 2-—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ? –û—á–µ–≤–∏–Ω–æ, –æ—Ç–≤–µ—Ç = 2, —Ç.–∫. –µ—Å–ª–∏ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ, –≤—Ç–æ—Ä–æ–π -- –Ω–∞ –≤—Ç–æ—Ä–æ–º, —Ç–æ –æ–±–∞ –æ–Ω–∏ –±—É–¥—É—Ç –≤—ã—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ 100% –∏–∑ –∫–∞–∂–¥–æ–≥–æ —è–¥—Ä–∞ –Ω–∏ —Ä–∞–∑—É –Ω–µ —É—Ö–æ–¥—è –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É. –°—Ç–∞–Ω–µ—Ç –ª–∏ –∫–æ–¥ –±—ã—Å—Ç—Ä–µ–µ, —É–≤–µ–ª–∏—á—å –º—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –≤ 2 —Ä–∞–∑–∞? –ù–µ—Ç. –ï—Å–ª–∏ –º—ã –¥–æ–±–∞–≤–∏–º –¥–≤–∞ –ø–æ—Ç–æ–∫–∞, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç? –£ –∫–∞–∂–¥–æ–≥–æ —è–¥—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ –≤—Ç–æ—Ä–æ–º—É –ø–æ—Ç–æ–∫—É. –ü–æ—Å–∫–æ–ª—å–∫—É —è–¥—Ä–æ –Ω–µ —Ä–µ–∑–∏–Ω–æ–≤–æ–µ, –∞ –∂–µ–ª–µ–∑–Ω–æ–µ, —á–∞—Å—Ç–æ—Ç–∞ —Ç–∞ –∂–µ —Å–∞–º–∞—è, —Ç–æ –Ω–∞ –≤—ã—Ö–æ–¥–µ –Ω–∞ –∫–∞–∂–¥–æ–º —è–¥—Ä–µ –º—ã –±—É–¥–µ–º –∏–º–µ—Ç—å –ø–æ –¥–≤–∞ –ø–æ—Ç–æ–∫–∞, –∏—Å–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º, –ø–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, 120 –º—Å. –ê –ø–æ—Å–∫–æ–ª—å–∫—É –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ, —Ç–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–≤—ã–π –ø–æ—Ç–æ–∫ —Å—Ç–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ 50% –æ—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–¥–∞–≤ 50% –≤—Ç–æ—Ä–æ–º—É –ø–æ—Ç–æ–∫—É. –î–æ–±–∞–≤—å –º—ã –µ—â—ë –ø–æ –¥–≤–∞ –ø–æ—Ç–æ–∫–∞, –º—ã —Å–Ω–æ–≤–∞ –ø–æ–¥–µ–ª–∏–º –º–µ–∂–¥—É –≤—Å–µ–º–∏ —ç—Ç–æ —è–¥—Ä–æ –∏ –∫–∞–∂–¥–æ–º—É –¥–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø–æ 33,33%. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –µ—Å–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å ThreadPool –∫–∞–∫ –∏–¥–µ–∞–ª—å–Ω—ã–π –∏ –±–µ–∑ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∞ –≤—Å–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —É –Ω–µ–≥–æ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –∫–∞–∫ –º–∏–Ω–∏–º—É–º ConcurrentQueue, —Ç–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –µ—â—ë –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞: contention, —Ç.–µ. —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ø–æ—Ä–∞ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏ –∑–∞ –Ω–µ–∫–∏–π —Ä–µ—Å—É—Ä—Å. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Å–ø–æ—Ä –±—É–¥–µ—Ç –∏–¥—Ç–∏ –∑–∞ —Å–º–µ–Ω—É —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –≥–æ–ª–æ–≤—É –∏ —Ö–≤–æ—Å—Ç –æ—á–µ—Ä–µ–¥–∏ –≤–Ω—É—Ç—Ä–∏ ConcurrentQueue. –ê —ç—Ç–æ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å *—Å–Ω–∏–∑–∏—Ç* –æ–±—â—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ö–æ—Ç—å –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ: –ø—Ä–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –≤ 100 –º—Å –æ—á–µ–Ω—å –Ω–∏–∑–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞ —Ä–∞–∑—Ä—ã–≤ –∫–æ–¥–∞ –º–µ—Ç–æ–¥–æ–≤ `Enqueue` –∏ `TryDequeue` —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ç–∞–π–º–µ—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å `Enqueue` –ª–∏–±–æ `TryDequeue` (contention —É –Ω–∏—Ö –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Enqueue` + `Enqueue`), –ª–∏–±–æ —Å –æ—á–µ–Ω—å –Ω–∏–∑–∫–æ–π –¥–æ–ª–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ -- –Ω–∞ —Ä–∞–∑–Ω—ã—Ö).
2. –ù–∞ –º–∞–ª–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –¥–µ–ª–µ–≥–∞—Ç–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞–ª–æ —Ç–æ–≥–æ, —á—Ç–æ –Ω–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ, –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –Ω–∞ 2 –ø–æ—Ç–æ–∫–∞—Ö, —Ç.–∫. –Ω–∞ –º–∞–ª–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–æ–≤ –æ—á–µ—Ä–µ–¥–∏ ConcurrentQueue, —á—Ç–æ –≤–≤–æ–¥–∏—Ç –æ—á–µ—Ä–µ–¥—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ contention –∏ –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç -- –µ—â—ë –±–æ–ª—å—à–µ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û–¥–Ω–∞–∫–æ –µ—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ 1 —è–¥—Ä–µ –∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö, –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–¥—Ä–∞—Ö —Ä–∞–±–æ—Ç–∞ –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–µ–µ;
3. –ò –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–ª–µ–≥–∞—Ç–æ–≤ -- –∫–æ–≥–¥–∞ —Å–∞–º–∏ –¥–µ–ª–µ–≥–∞—Ç—ã –Ω—É –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ. –¢–æ–≥–¥–∞ –ø–æ–ª—É—á–∏—Ç—Å—è, —á—Ç–æ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –≤—ã –Ω–∞—Ä–∞—â–∏–≤–∞–µ—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è contention –≤ –æ—á–µ—Ä–µ–¥–∏ ConcurrentQueue. –í –∏—Ç–æ–≥–µ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±–æ—Ä–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É Head –∏ Tail –Ω–∞—Å—Ç–æ–ª—å–∫–æ –Ω–µ—É–¥–∞—á–Ω–æ —á–∞—Å—Ç–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, —á—Ç–æ –≤—Ä–µ–º—è contention —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∞–º–∏—Ö –¥–µ–ª–µ–≥–∞—Ç–æ–≤. –ê —Å–∞–º—ã–π –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –∏—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è -- –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, **–≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ**. –ò —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–∞–º–∏: –Ω–∞ –º–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å 8 —è–¥—Ä–∞–º–∏ (16 –≤ HyperThreading) –∫–æ–¥ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ 8 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ.

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∏—Å–ø–æ–ª–Ω—è—Ç—å CPU-bound –∫–æ–¥ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ—Ç–æ–∫–æ–≤ –≤—ã—à–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è–¥–µ—Ä –Ω–µ —Å—Ç–æ–∏—Ç, –∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ –¥–∞–∂–µ –∑–∞–º–µ–¥–ª–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞ –≤ —Å–æ–≤—Å–µ–º –≤—ã—Ä–æ–∂–¥–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –ª—É—á—à–µ –±—ã –≤–æ–æ–±—â–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –æ–¥–Ω–æ–º.

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç: –∏—â–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã

> ‚ö†Ô∏è *–ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏*

–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç **–≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã**. –ò–º–µ–µ—Ç—Å—è –≤–≤–∏–¥—É, –∫–æ–Ω–µ—á–Ω–æ –∂–µ, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –¥–µ–ª–µ–≥–∞—Ç–æ–≤. –ß—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —Ö–æ—Ä–æ—à–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π, –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–±—ã –∫–∞–∫–æ–π: –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å *–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π*. –ò –ø–æ–º–∏–º–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á –Ω–∞ ThreadPool, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∫–∞–∫ —á–µ—Ä–µ–∑ TPL —Ç–∞–∫ –∏ —á–µ—Ä–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤–∑—è—Ç—å –æ–±—ã—á–Ω—ã–π ThreadPool, —Ç–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ –∏–∑–º–µ—Ä–∏—Ç—å –∏–∑–¥–µ—Ä–∂–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ ThreadPool –≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —Ç–∞–∫—Ç–∞—Ö (–º–æ–∂–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ –∏ –≤ —á—ë–º-—Ç–æ –±–æ–ª–µ–µ –ø—Ä–∏–≤—ã—á–Ω–æ–º —Ç–∏–ø–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥, –Ω–æ —Ç–∞–º –Ω–∞ –º–Ω–æ–≥–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –≤–ø–æ–ª–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω—É–ª–∏. –ê –Ω–∏–∂–µ —Ç–∞–∫—Ç–æ–≤ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç):

{.wide}
```csharp
ConcurrentQueue<Record> bag = new ConcurrentQueue<UserQuery.Record>();
unsafe delegate*<long> rdtsc;
long rdtscCallCost;
long[] lastValues = new long[100];

unsafe void Main()
{
	rdtsc = CreateRdtscMethod();
	var rdtsc_costs = new List<long>(10000);
	
	for(int i = 0; i < 10000; i++)
	{
		rdtsc_costs.Add(Math.Abs(rdtsc()-rdtsc()));
	}
	
	rdtscCallCost = (long)rdtsc_costs.Average();
	
	for(int i = 0; i < 1_000_000; i++)
	{
		ThreadPool.QueueUserWorkItem(TraceWork, bag);
	}
	
	Console.Read();
	bag.Dump();
}

unsafe void TraceWork(object x)
{
	var rd = rdtsc();
	var tid = Environment.CurrentManagedThreadId;
	var last = lastValues[tid];
	
	bag.Enqueue(new Record { 
		Ticks = rd - last - rdtscCallCost,
		TID = Environment.CurrentManagedThreadId
	});
	
	lastValues[tid] = rdtsc();
}

struct Record {
	public long Ticks;
	public int TID;
}

unsafe static delegate*<long> CreateRdtscMethod()
{
	var ptr = VirtualAlloc(IntPtr.Zero, (uint)rdtscAsm.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	Marshal.Copy(rdtscAsm, 0, ptr, rdtscAsm.Length);
	return (delegate*<long>)ptr;
}

const uint PAGE_EXECUTE_READWRITE = 0x40;
const uint MEM_COMMIT = 0x1000;

[DllImport("kernel32.dll", SetLastError = true)]
static extern IntPtr VirtualAlloc(
	IntPtr lpAddress, uint dwSize,
	uint flAllocationType, uint flProtect);

static readonly byte[] rdtscAsm =
{
	0x0F, 0x31, // rdtsc
    0xC3        // ret
};

```

–ó–¥–µ—Å—å –º—ã –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ `CreateRdtscMethod` –≤—ã–¥–µ–ª—è–µ–º –ø–∞–º—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é —É Windows –∏ –ø–æ–º–µ—á–∞–µ–º –µ—ë –∫–∞–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—É—é –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–¥–∞. –ú–µ—Ç–æ–¥ —ç—Ç–æ—Ç –ø–æ–º–µ—â–∞–µ—Ç –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –ø–∞–º—è—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∞—Å—Å–∏–≤–∞ `rdtscAsm`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –≤—ã–∑–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `rdtsc` –∏ –≤–æ–∑–≤—Ä–∞—Ç –≤ –≤—ã–∑—ã–≤–∞–µ–º—ã–π –∫–æ–¥. –ü–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–∏–≤–æ–¥–∏–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ –º–µ—Ç–æ–¥ –∏ –ø–æ–ª—É—á–∞–µ–º —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º .NET –º–µ—Ç–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ asm –∫–æ–¥–∞ –≤—ã–∑–æ–≤–∞ CPU –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `rdtsc`, –∫–æ—Ç–æ—Ä–∞—è —á–∏—Ç–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ TSC (Time Stamp Counter) –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö EDX:EAX 64-–±–∏—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫—Ç–æ–≤ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–±—Ä–æ—Å–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –°—Ç–∞—Ä—à–∞—è —á–∞—Å—Ç—å —á–∏—Å–ª–∞ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–∞, —Ç.–∫. –º—ã —Å—á–∏—Ç–∞–µ–º **—Ä–∞–∑–Ω–∏—Ü—É**, –∞ –ø–æ—Ç–æ–º—É —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ 2-—Ö –≤—ã–∑–æ–≤–æ–≤ –º–µ—Ç–æ–¥–∞ `rdtsc()` –¥–∞—Å—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫—Ç–æ–≤ –º–µ–∂–¥—É –Ω–∏–º–∏.

–ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ–º –≤ –ø—É–ª –æ–¥–∏–Ω –º–∏–ª–ª–∏–æ–Ω –¥–µ–ª–µ–≥–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç –≤ –æ—á–µ—Ä–µ–¥—å `ConcurrentQueue` —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º `rdtsc` –∏ –ø—Ä–æ—à–ª—ã–º –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º –ø–æ—Ç–æ–∫–µ. –°–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–æ–º–µ—Ä –ø–æ—Ç–æ–∫–∞ –≤–∞–∂–Ω–æ, —Ç.–∫. –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–¥—Ä–∞—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞.

[>]: –ò–Ω–æ–≥–¥–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–≥—Ä–æ–º–Ω—ã–µ, –∏–¥—É—â–∏–µ –º–∏–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –ø—Ä–æ–±–µ–ª—ã. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø–æ—Ç–æ–∫ –±—ã–ª –ø—Ä–µ—Ä–≤–∞–Ω –∏ –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ –Ω–∞ —Ç–æ–º –∂–µ —è–¥—Ä–µ –æ—Ç—Ä–∞–±–æ—Ç–∞–ª–∏ –¥—Ä—É–≥–∏–µ –ø–æ—Ç–æ–∫–∏, –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–∞–∂–µ –Ω–µ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. 

–ü–æ—Å–ª–µ –∑–∞–º–µ—Ä–∞ –º—ã –ø–æ–ª—É—á–∏–º, —á—Ç–æ –∫–æ–≥–¥–∞ –ø—É–ª —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–¥–∞—á—É, –æ–Ω —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª –Ω–∞ 1 –ø–æ—Ç–æ–∫–µ –∏ –ø—Ä–æ–≤–æ–¥–∏–ª —á–µ—Ä–µ–∑ —Å–µ–±—è –¥–µ–ª–µ–≥–∞—Ç—ã —Å –∏–∑–¥–µ—Ä–∂–∫–∞–º–∏ –Ω–∞ —Å–≤–æ—é —Ä–∞–±–æ—Ç—É, –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã–º–∏ `100-200` —Ç–∞–∫—Ç–æ–≤. –î–∞–ª–µ–µ, –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –ø—É–ª–∞ —Ä–∞—Å—Ç—ë—Ç –∏ —Ü–µ–Ω–∞ –∏–∑–¥–µ—Ä–∂–µ–∫: —á–µ—Ä–µ–∑ –æ—Ç–º–µ—Ç–∫—É `200-300` –æ–Ω–∞ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ `500-900` —Ç–∞–∫—Ç–æ–≤. –ï–¥–∏–Ω–∏—á–Ω—ã–µ `1500-2500` —Ç–∞–∫—Ç–æ–≤ –ø—Ä–∏—Ö–æ–¥—è—Ç—Å—è, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–∞ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤–∑—è—Ç—å –¥–µ–ª–µ–≥–∞—Ç –∏–∑ –æ—á–µ—Ä–µ–¥–∏, –∫–æ–≥–¥–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ —Ä–∞–∑–±–∏—Ä–∞—é—Ç –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –¥–µ–ª–µ–≥–∞—Ç—ã, –∞ —Ç–æ—Ç, —á—Ç–æ *–ø—Ä–∏—Ç–æ—Ä–º–æ–∑–∏–ª* –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –±–æ—Ä–µ—Ç—Å—è –∑–∞ —Å–º–µ–Ω—É "—Ö–≤–æ—Å—Ç–∞" –æ—á–µ—Ä–µ–¥–∏.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –ø–æ–ª—É—á–∏–º —Å–∏—Ç—É–∞—Ü–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π —á–µ—Ä–µ–¥—É—é—Ç—Å—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ–ª–µ–∑–Ω–æ–π —Ä–∞–±–æ—Ç—ã (`40` —Ç–∞–∫—Ç–æ–≤) –∏ –≤—ã–±–æ—Ä–∞ —Å–ª–µ–¥—É—é—â–µ–π –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã –ø—É–ª–æ–º (–ø—É—Å—Ç—å, `800` —Ç–∞–∫—Ç–æ–≤). –ï—Å–ª–∏ —É—á–µ—Å—Ç—å, —á—Ç–æ —Ä–∞–±–æ—Ç–∞ –∏–¥—ë—Ç –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å, –ª–µ–≥–∫–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, –∫ —á–µ–º—É —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç. –ï—Å–ª–∏ –≤ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –Ω–∞ 8 –ø–æ—Ç–æ–∫–∞—Ö –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∏ —Ç–æ–ª—å–∫–æ —É –æ–¥–Ω–æ–≥–æ -- –≤—ã–±–æ—Ä —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–µ–ª–µ–≥–∞—Ç–∞, —Ç–æ —Ç–æ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ—Ç –≤—ã–±–æ—Ä –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, —Ç.–∫. –Ω–∏ —Å –∫–µ–º –Ω–µ —Å–æ–ø–µ—Ä–Ω–∏—á–∞–µ—Ç. –û–¥–Ω–∞–∫–æ –µ—Å–ª–∏ —Ç–∞–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ —É–∂–µ –¥–≤–∞, —Ç–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —Å–ø–æ—Ä –∑–∞ –æ–±—â–∏–π —Ä–µ—Å—É—Ä—Å: –æ—á–µ—Ä–µ–¥—å –¥–µ–ª–µ–≥–∞—Ç–æ–≤. –ï—Å–ª–∏ —Ç—Ä–∏, —Å–ø–æ—Ä —Å–∏–ª—å–Ω–µ–µ –∏ –æ—Ç —Ç–æ–≥–æ - –¥–æ–ª—å—à–µ (–∫–∞–∫ —Ä–∞–∑ —Ç—É—Ç –æ–Ω, –Ω–∞–≤–µ—Ä–Ω—è–∫–∞, –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –≤ `500` —Ç–∞–∫—Ç–æ–≤). –ï—Å–ª–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–µ–ª–µ–≥–∞—Ç–∞, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç? –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ø–æ—Ä–∞. –î–∏—Å—Ç–∞–Ω—Ü–∏—è —Å–ø–æ—Ä–∞ —Ä–∞—Å—Ç—ë—Ç. –ü—É–ª –ø—Ä–∏ —ç—Ç–æ–º —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑–∫–æ –ø–∞–¥–∞–µ—Ç, –∞ –∑–Ω–∞—á–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤. –≠—Ç–æ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–ø–æ—Ä –∑–∞ –æ—á–µ—Ä–µ–¥—å, —É–≤–µ–ª–∏—á–∏–≤–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—é —Å–ø–æ—Ä–∞. –í –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–∞–∫–æ–π, —á—Ç–æ –≤ –æ–¥–∏–Ω –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª–µ–∑–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è 1 –ø–æ—Ç–æ–∫. –û—Å—Ç–∞–ª—å–Ω—ã–µ -- —Å–ø–æ—Ä—è—Ç, –∫—Ç–æ –∑–∞–±–µ—Ä—ë—Ç —Å –Ω–µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ. 

–ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∞—è –∏ –∑–∞–Ω–∏–º–∞–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, 40 —Ç–∞–∫—Ç–æ–≤ (–∫–∞–∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–µ—Ç–æ–¥–∞ `TraceWork`), —Ç–æ –∏–∑–¥–µ—Ä–∂–∫–∏ –¥–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–¥–∞—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ –±—É–¥—É—Ç —Å—Ç–æ–∏—Ç—å `1250% - 2000%` –æ—Ç –ø–æ–ª–µ–∑–Ω–æ–≥–æ –∫–æ–¥–∞. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —ç—Ç—É –∑–∞–¥–∞—á—É –¥–µ—à–µ–≤–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —á–µ–º –Ω–∞ ThreadPool. –û—Ç—Ç–∞–ª–∫–∏–≤–∞—è—Å—å –æ—Ç —ç—Ç–∏—Ö —Ü–∏—Ñ—Ä –º–æ–∂–Ω–æ —Å–º–µ–ª–æ –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –µ—Å–ª–∏ –±—Ä–∞—Ç—å –∏–∑–¥–µ—Ä–∂–∫–∏ –∑–∞ `200-300` —Ç–∞–∫—Ç–æ–≤, –∞ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å —É–º–µ—Ä–µ–Ω–Ω–æ-–±–æ–ª—å—à–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏, –∏ –µ—Å–ª–∏ –≤–∑—è—Ç—å –∏—Ö –∑–∞ 5%, —Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω—å—à–µ `(250 / 5 * 95) = 4750` —Ç–∞–∫—Ç–æ–≤. –¢.–µ. –∫–æ–¥–∞ –≤ –¥–µ–ª–µ–≥–∞—Ç–µ –¥–æ–ª–∂–Ω–æ –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ. –ù–æ –∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–Ω–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å, –≤ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ —Å–ª—É—á–∞–µ–º ThreadPool, —Ç.–∫. –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–æ–º.

–í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∂–µ —Å–∏—Ç—É–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ–π. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω –ø—Ä–∏–º–µ—Ä –¥–ª—è 1 –º–ª–Ω –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –≤ ThreadPool –Ω–∞ 6 (12 HyperThreading) —è–¥—Ä–∞—Ö. –¢.–µ. 24 –ø–æ—Ç–æ–∫–∞—Ö ThreadPool:

![](./img/TasksSpreadInCpuTicks_first_1000.png)

–ü–µ—Ä–≤–∞—è 1,000 –∑–Ω–∞—á–µ–Ω–∏–π: –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –ø—É–ª –µ—â—ë –Ω–µ –ø—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏—è –≤ —Ä–µ–∑–∫–æ–º—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤ –∏ —Ä–∞–±–æ—Ç–µ—Ç –±–æ–ª–µ–µ-–º–µ–Ω–µ–µ –ø—Ä–∏–µ–º–ª–∏–º–æ. {.description}

![](./img/TasksSpreadInCpuTicks.png) 

–í–µ—Å—å –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π: –¥–∞–ª–µ–µ –ø—Ä—É–ª –ø—Ä–∏–Ω—è–ª –Ω–µ–≤–µ—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏ –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–∑–∫–æ —É—Ö—É–¥—à–∏–ª–æ—Å—å {.description}

–ò –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å—Ç—Ä–æ–∏–º "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π. –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –≤—ã—à–µ –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ –∫–∞–∫–∏–µ 50-–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –∏–∑–¥–µ—Ä–∂–µ–∫ –ø—É–ª–∞. –ó–∞–º–µ—Ä—ã –ø—Ä–∏–≤–µ–¥—ë–º –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ –ª–µ–≥–µ–Ω–¥–µ –¥–ª–∏–Ω –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ "—Ä–∞–±–æ—Ç—ã" –º–µ—Ç–æ–¥–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ –≤ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤: 

![](./img/TasksSpreadInCpuTicks_tp-destribution.png)

–ö–∞–∂–¥–∞—è –∫—Ä–∏–≤–∞—è -- —ç—Ç–æ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –¥–ª–∏–Ω–Ω—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ü–∏–∫–ª–∞. –ë–æ–ª–µ–µ –±–ª–µ–∫–ª—ã–µ –ª–∏–Ω–∏–∏ -- –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Ü–∏–∫–ª—ã –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ -- –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∞—è —Ä–∞–±–æ—Ç–∞ –º–µ—Ç–æ–¥–∞ –≤ –ø—É–ª–µ –ø–æ—Ç–æ–∫–æ–≤. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–π "—É—Ö–æ–¥—è—Ç –≤–ø—Ä–∞–≤–æ" –ø–æ –æ—Å–∏ –∞–±—Å—Ü–∏—Å—Å. –¢.–µ. –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ (–µ—Å–ª–∏ –≤—Å—ë —Å–ª–æ–∂–∏—Ç—å) –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∑–æ–Ω–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —Ä–∞–±–æ—Ç—É ThreadPool: –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ —Å–∏—Ç—É–∞—Ü–∏–π, –∫–æ–≥–¥–∞ –º–µ–∂–¥—É –æ–∫–æ–Ω—á–∞–Ω–∏–µ–º —Ä–∞–±–æ—Ç—ã –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –º–µ—Ç–æ–¥–∞ –Ω–∞ –ø–æ—Ç–æ–∫–µ –ø—É–ª–∞ –∏ –≤–∑—è—Ç–∏–µ–º –≤ —Ä–∞–±–æ—Ç—É —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –£–≤–µ–ª–∏—á–∏–º –±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—É—é —á–∞—Å—Ç—å:

![](./img/TasksSpreadInCpuTicks_tp-destribution-zoom.png)

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –Ω–∞ –º–∞–ª—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö —Ä–∞–±–æ—Ç—ã –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ª–æ–∂–∞—Ç—Å—è –±–ª–∏–∂–µ –∫ –ø–∏–∫–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º. –ó–∞—Ç–µ–º –ø–∏–∫–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω—É, –∑–∞—Ç–µ–º –Ω–∞ –Ω–∞—á–∞–ª–æ –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è —Å–Ω–æ–≤–∞ –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç —Ö—É–¥—à–µ–π –∑–∞–¥–µ—Ä–∂–∫–∏. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –∫—Ä–∞–π–Ω–µ –ø–ª–æ—Ö–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –æ—Ç—Ä–∞–±–æ—Ç–∫–æ–π –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –∫—Ä–∞–π–Ω–µ –≤—ã—Å–æ–∫–∞. –ü–ª—é—Å –∫–æ –≤—Å–µ–º—É –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –∑–∞–¥–µ—Ä–∂–µ–∫ —É—Ö–æ–¥–∏—Ç "—Ö–≤–æ—Å—Ç–æ–º" –≤–ø—Ä–∞–≤–æ (—Å–º –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫), *—Å—Ä–µ–¥–Ω—è—è* –∑–∞–¥–µ—Ä–∂–∫–∞ –±—É–¥–µ—Ç —Å–º–µ—â–µ–Ω–∞ –≤–ø—Ä–∞–≤–æ –∏ –±—É–¥–µ—Ç –∫–æ–ª–µ–±–∞—Ç—å—Å—è –≤ —Ä–∞–π–æ–Ω–µ 600 —Ç–∞–∫—Ç–æ–≤ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é. 

–í—Ç–æ—Ä–æ–µ, —á—Ç–æ —Å—Ç–æ–∏—Ç –ø–æ—è—Å–Ω–∏—Ç—å: –∑–∞–¥–µ—Ä–∂–∫–∏ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω—ã –±–æ—Ä—å–±–æ–π –∑–∞ —Ä–µ—Å—É—Ä—Å. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ -- –∑–∞ –≥–æ–ª–æ–≤—É –∏ —Ö–≤–æ—Å—Ç –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á. –ê –ø–æ—Ç–æ–º—É –æ–Ω–∏ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω—ã —É—Ä–æ–≤–Ω–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞. –¢—Ä–∏ –ø–∏–∫–∞ -- —ç—Ç–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –±–æ—Ä—å–±—ã –∑–∞ –æ–±—â–∏–π —Ä–µ—Å—É—Ä—Å. –ê —Ç–æ —á—Ç–æ –∏—Ö —á—ë—Ç–∫–æ —Ç—Ä–∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—É–ª –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ —É–≤–µ–ª–∏—á–∏–ª –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ —Ç—Ä–∏ —Ä–∞–∑–∞: –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–±—ä—ë–º–∞—Ö —Ä–∞–±–æ—Ç. –ü—Ä–∏—á—ë–º –¥–µ–ª–µ–ª —ç—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —á–µ—Ä–µ–∑ —Ç–µ –∂–µ —á–∏—Å–ª–∞ —É—Ä–æ–≤–Ω—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.

–ù–æ –æ–±–æ –≤—Å—ë–º –ø–æ –ø–æ—Ä—è–¥–∫—É.

### –ò—â–µ–º –∏–¥–µ–∞–ª

–î–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –¥–µ–π—Å—Ç–≤–∏—è ThreadPool'–∞ —Ç–∞–∫ —á—Ç–æ–±—ã —ç—Ç–æ –ª–æ–∂–∏–ª–æ—Å—å –≤ –Ω–∞—à–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ —Ö–æ—Ä–æ—à–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∫–æ–¥–∞ –∑–∞–¥–∞—á–∏ –∫ –∫–æ–¥—É –∏–∑–¥–µ—Ä–∂–µ–∫ –ø—É–ª–∞ 5% –∫ 95%:

```csharp
unsafe void TraceWork(object x)
{
	var rd = rdtsc();

	ulong sum = (ulong)rd;
	for (int i = 0; i < 600; i++)
	{
		sum = sum + (ulong)i;
	}
	var end = rdtsc();
	bag.Enqueue(new Record { 
		Ticks = end - rd - rdtscCallCost,
		TID = Environment.CurrentManagedThreadId
	});
}
```

`Ticks` –±—É–¥–µ—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 4700 —Ç–∞–∫—Ç–æ–≤ (–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ—ç—Ç–æ–º—É –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è). –ü–æ—Å–ª–µ —á–µ–≥–æ –≤–µ—Ä–Ω—ë–º –∫–æ–¥ –¥–ª—è –∑–∞–º–µ—Ä–∞ –∏–∑–¥–µ—Ä–∂–µ–∫ –ø—É–ª–∞:

```csharp
unsafe void TraceWork(object x)
{
	var rd = rdtsc();
	var tid = Environment.CurrentManagedThreadId;
	var last = lastValues[tid];
	
	ulong sum = (ulong)rd;
	for (int i = 0; i < 600; i++)
	{
		sum = sum + (ulong)i;
	}
	
	bag.Enqueue(new Record { 
		Ticks = rd - last - rdtscCallCost,
		TID = Environment.CurrentManagedThreadId
	});
	
	lastValues[tid] = rdtsc();
}
```

–ß—Ç–æ –º—ã –ø–æ–ª—É—á–∏–º:

![](./img/TasksSpreadInCpuTicks_5-95_unsorted.png)

–û—Ç–Ω–æ—à–µ–Ω–∏–µ 5% –∏–∑–¥–µ—Ä–∂–µ–∫ –∫ 95% —Ä–∞–±–æ—Ç—ã –Ω–∞ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ. –ù–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ {.description}

–í—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä–∞—à–Ω–æ. –î–∞–≤–∞–π—Ç–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: —Ç–∞–∫ –ª–∏ –º–Ω–æ–≥–æ "–ø–∏–∫–æ–≤—ã—Ö" –∑–Ω–∞—á–µ–Ω–∏–π.

![](./img/TasksSpreadInCpuTicks_5-95_sorted.png)

–û—Ç–Ω–æ—à–µ–Ω–∏–µ 5% –∏–∑–¥–µ—Ä–∂–µ–∫ –∫ 95% —Ä–∞–±–æ—Ç—ã –Ω–∞ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑–¥–µ—Ä–∂–∫–∏ {.description}

–ò –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ü–∏–∫–ª–∞ –¥–æ `100_000` –∏—Ç–µ—Ä–∞—Ü–∏–π. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–∞–∫–æ–≥–æ —Ü–∏–∫–ª–∞ —Å—Ç–∞–ª–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω–∞ 87,000 —Ç–∞–∫—Ç–∞–º, —á—Ç–æ —Å–æ—Å—Ç–∞–≤–∏—Ç –±–æ–ª–µ–µ `99%` –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã (–∏—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å —Å –∏–∑–¥–µ—Ä–∂–∫–∞–º–∏). –¢–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∏–º, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑–¥–µ—Ä–∂–µ–∫ —Å—Ç–∞–ª–æ –∑–∞–Ω–∏–º–∞—Ç—å –æ–∫–æ–ª–æ 550 —Ç–∞–∫—Ç–æ–≤, —á—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–¥–µ–∞–ª:

![](./img/TasksSpreadInCpuTicks_good_sorted.png)

–ê —Ç–µ–ø–µ—Ä—å —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –∏ –ø—É–ª–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∫–∞–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö, –¥–∞–≤–∞–π—Ç–µ –ø–æ–º–æ—Ç—Ä–∏–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã—É–¥–∏—Ç—å –∏–∑ —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞ (ThreadPool, .NET 5/.NET 6 (–æ–¥–∏–Ω–∞–∫–æ–≤–æ))

[>]: * **–ò—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞**: –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ç–µ–ª–µ TraceWork: –Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –µ–≥–æ —Ä–∞–±–æ—Ç—ã
* **–ò–∑–¥–µ—Ä–∂–∫–∏, —Ç–∞–∫—Ç–æ–≤**: —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞—Å—Ö–æ–¥—É—é—Ç—Å—è ThreadPool'–æ–º –Ω–∞ –≤—ã–±–æ—Ä —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–µ—Ç–æ–¥–∞
* **–†–∞–±–æ—Ç–∞, —Ç–∞–∫—Ç–æ–≤**: —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞—Å—Ö–æ–¥—É–µ—Ç—Å—è —Ç–µ–ª–æ–º –º–µ—Ç–æ–¥–∞ (—Å —Ü–∏–∫–ª–æ–º)
* **–¶–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã**: (–∏–∑–¥–µ—Ä–∂–∫–∏+—Ä–∞–±–æ—Ç–∞)/–∫–æ–ª-–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞.
* **–í—Ä–µ–º—è, –º—Å**: –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö, —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è
* **‚àë –∏–∑–¥–µ—Ä–∂–µ–∫, –º—Å**: –æ–±—â–µ–µ –≤—Ä–µ–º—è –∏–∑–¥–µ—Ä–∂–µ–∫ –ø–æ –≤—Å–µ–º –ø–æ—Ç–æ–∫–∞–º
* **‚àë —Ä–∞–±–æ—Ç—ã, –º—Å**: –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ –≤—Å–µ–º –ø–æ—Ç–æ–∫–∞–º

| –ò—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ | –ò–∑–¥–µ—Ä–∂–∫–∏, —Ç–∞–∫—Ç–æ–≤ | –†–∞–±–æ—Ç–∞, —Ç–∞–∫—Ç–æ–≤ | –¶–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã | –ò–∑–¥–µ—Ä–∂–∫–∏, % | –†–∞–±–æ—Ç–∞, % | –í—Ä–µ–º—è,–º—Å | –ü–æ—Ç–æ–∫–æ–≤ | –ò–∑–¥, —Å—É–º, –º—Å | –†–∞–±, —Å—É–º, –º—Å |
|----------------|------------------|----------------|---------------------|-------------|-----------|----------|---------|--------------|--------------|
| 0              | 600              | 134            | ?                   | 81,73       | 18,27     | 97       | 12      | 951,29       | 212,71       |
| 5              | 679              | 225            | 180,91              | 75,12       | 24,88     | 85       | 13      | 830,08       | 274,92       |
| 11             | 640              | 209            | 77,30               | 75,34       | 24,66     | 84       | 12      | 759,44       | 248,56       |
| 51             | 731              | 850            | 31,02               | 46,22       | 53,78     | 76       | 13      | 456,63       | 531,37       |
| 101            | 672              | 1360           | 20,13               | 33,06       | 66,94     | 92       | 13      | 395,40       | 800,60       |
| 501            | 486              | 5692           | 12,33               | 7,87        | 92,13     | 141      | 12      | 133,19       | 1558,81      |
| 1001           | 530              | 11634          | 12,15               | 4,36        | 95,64     | 237      | 27      | 278,80       | 6120,20      |
| 5001           | 408              | 37793          | 7,64                | 1,07        | 98,93     | 617      | 12      | 79,15        | 7324,85      |
| 10001          | 396              | 70788          | 7,12                | 0,56        | 99,44     | 1118     | 12      | 74,72        | 13341,28     |
| 100001         | 492              | 725510         | 7,26                | 0,07        | 99,93     | 10409    | 12      | 84,72        | 124823,28    |

–ò–ª–∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –¥–ª—è –∏–∑–¥–µ—Ä–∂–µ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ —Ä–∞–±–æ—Ç—ã:

![](./img/TasksSpreadInCpuTicks_all-task-lengths.png)

–ò–∑ —Ç–∞–±–ª–∏—Ü—ã –º–æ–∂–Ω–æ –ø–æ–¥—á–µ—Ä–ø–Ω—É—Ç—å, —á—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–∑–¥–µ—Ä–∂–µ–∫ –ø—É–ª–∞ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –æ—Å–æ–±–µ–Ω–Ω–æ —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –º–∞–ª—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∏ —á–µ–º —Ä–∞–±–æ—Ç—ã –±–æ–ª—å—à–µ, —Ç–µ–º –º–µ–Ω—å—à–µ –≤–ª–∏—è–Ω–∏—è. –¢–∞–∫, —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–∞ 5% - 95%, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–∞ –Ω–µ–≤–∏–¥–∏–º–∞—è –ª–∏–Ω–∏—è, –≤—ã—à–µ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–∏–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –∏–∑–¥–µ—Ä–∂–µ–∫. –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç, —É—Å–ª–æ–≤–Ω–æ, 500 –∏—Ç–µ—Ä–∞—Ü–∏—è–º —Ü–∏–∫–ª–∞ —Å–ª–æ–∂–µ–Ω–∏—è —á–∏—Å–µ–ª. –ú–Ω–æ–≥–æ —ç—Ç–æ –∏–ª–∏ –º–∞–ª–æ? –ü–æ–∂–∞–ª—É–π, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ —Å —É—á—ë—Ç–æ–º —Ç–æ–≥–æ, –∫–∞–∫ –º—ã –ª—é–±–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `async/await` –ø–ª–æ—Ç–Ω–æ–π –≥—Ä—è–¥–æ–π –≤—ã–∑–æ–≤–æ–≤ –∏ –Ω–∞ —Å–∫–æ–ª—å–∫–æ –∫–æ—Ä–æ—Ç–∫–∏—Ö –¥–µ–ª–µ–≥–∞—Ç–æ–≤ —Ä–∞–∑–±–∏—Ç—ã –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ —ç—Ç–∏ –≤—ã–∑–æ–≤—ã.

–ó–∞–±–µ–≥–∞—è –≤–ø–µ—Ä—ë–¥ —Ö–æ—á–µ—Ç—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, —Ä–µ—á—å –æ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–π–¥—ë—Ç —á—É—Ç—å –ø–æ–∑–∂–µ (SmartThreadPool, .NET 5/.NET 6):

| –ò—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ | –ò–∑–¥–µ—Ä–∂–∫–∏, —Ç–∞–∫—Ç–æ–≤ | –†–∞–±–æ—Ç–∞, —Ç–∞–∫—Ç–æ–≤ | –¶–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã | –ò–∑–¥–µ—Ä–∂–∫–∏, % | –†–∞–±–æ—Ç–∞, % | –í—Ä–µ–º—è,–º—Å | –ü–æ—Ç–æ–∫–æ–≤ | –ò–∑–¥, —Å—É–º, –º—Å–µ–∫ | –†–∞–±, —Å—É–º, –º—Å–µ–∫ |
|----------------|------------------|----------------|---------------------|-------------|-----------|----------|---------|----------------|----------------|
| 0              | 133              | 54             | ?                   | 71,08       | 28,92     | 126      | 1       | 89,56          | 36,44          |
| 5              | 143              | 170            | 62,80               | 45,79       | 54,21     | 123      | 1       | 56,32          | 66,68          |
| 11             | 146              | 82             | 20,85               | 64,04       | 35,96     | 131      | 1       | 83,89          | 47,11          |
| 51             | 130              | 398            | 10,38               | 24,70       | 75,30     | 151      | 1       | 37,30          | 113,70         |
| 101            | 130              | 719            | 8,42                | 15,39       | 84,61     | 213      | 1       | 32,78          | 180,22         |
| 501            | 118              | 3007           | 6,24                | 3,79        | 96,21     | 614      | 1       | 23,28          | 590,72         |
| 1001           | 408              | 6020           | 6,42                | 6,36        | 93,64     | 597      | 3       | 113,89         | 1677,11        |
| 5001           | 497              | 35364          | 7,17                | 1,39        | 98,61     | 931      | 11      | 141,93         | 10099,07       |
| 10001          | 526              | 84755          | 8,53                | 0,62        | 99,38     | 1368     | 12      | 101,31         | 16314,69       |
| 100001         | 722              | 860697         | 8,61                | 0,08        | 99,92     | 13288    | 12      | 133,80         | 159322,20      |

–ò–∑ —Ç–∞–±–ª–∏—Ü—ã –≤–∏–¥–Ω–æ, —á—Ç–æ –∏–∑–¥–µ—Ä–∂–∫–∏ —É–ø–∞–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ, —É–ø–∞–ª–∞ —Ü–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã, —É–ø–∞–ª–æ —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ –ø–æ—Ç–æ–∫–∞–º. –ê –≤—Å—ë –ø–æ—á–µ–º—É? –ê –≤—Å—ë –ø–æ—Ç–æ–º—É —ç—Ç–æ —ç—Ç–æ—Ç –ø—É–ª —Å–æ–∑–¥–∞–Ω –≤ —Ç.—á. –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å–≤–µ—Ä—Ö–∫–æ—Ä–æ—Ç–∫–æ–π —Ä–∞–±–æ—Ç—ã –∏ –ø—É–ª *–¥–æ–≥–∞–¥—ã–≤–∞–µ—Ç—Å—è* –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—Å—é –µ—ë –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ –ø–ª—é—Å –≤ –Ω—ë–º –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ä–µ–¥–∫–æ-–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤. –ö–æ–≥–¥–∞ –∂–µ –æ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —Ä–∞–±–æ—Ç–∞ –ø–æ–π–¥—ë—Ç –±—ã—Å—Ç—Ä–µ–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –æ–Ω —Å–æ–∑–¥–∞—ë—Ç –¥–ª—è —ç—Ç–∏—Ö —Ü–µ–ª–µ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏.

–ò –¥–ª—è –∏–Ω—Ç–µ—Ä–µ—Å–∞ –¥–∞–≤–∞–π—Ç–µ —Ç–µ –∂–µ –∑–∞–º–µ—Ä—ã —Å–¥–µ–ª–∞–µ–º –¥–ª—è –ø—Ä—è–º–æ–≥–æ —Ü–∏–∫–ª–∞, –±–µ–∑ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ (–∏–∑–¥–µ—Ä–∂–∫–∏ = —Ü–µ–Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ `for(...)`):

| –ò—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ | –ò–∑–¥–µ—Ä–∂–∫–∏, —Ç–∞–∫—Ç–æ–≤ | –†–∞–±–æ—Ç–∞, —Ç–∞–∫—Ç–æ–≤ | –¶–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã | –ò–∑–¥–µ—Ä–∂–∫–∏, % | –†–∞–±–æ—Ç–∞, % | –í—Ä–µ–º—è,–º—Å | –ü–æ—Ç–æ–∫–æ–≤ | –ò–∑–¥, —Å—É–º, –º—Å–µ–∫ | –†–∞–±, —Å—É–º, –º—Å–µ–∫ |
|----------------|------------------|----------------|---------------------|-------------|-----------|----------|---------|----------------|----------------|
| 0              | 23               | 43             | ?                   | 34,39       | 65,61     | 51       | 1       | 17,54          | 33,46          |
| 5              | 19               | 45             | 12,98               | 29,42       | 70,58     | 40       | 1       | 11,77          | 28,23          |
| 11             | 18               | 75             | 8,59                | 20,09       | 79,91     | 45       | 1       | 9,04           | 35,96          |
| 51             | 19               | 386            | 7,96                | 4,72        | 95,28     | 112      | 1       | 5,28           | 106,72         |
| 101            | 18               | 699            | 7,11                | 2,64        | 97,36     | 157      | 1       | 4,15           | 152,85         |
| 501            | 16               | 2946           | 5,91                | 0,57        | 99,43     | 566      | 1       | 3,24           | 562,76         |
| 1001           | 15               | 5169           | 5,18                | 0,29        | 99,71     | 977      | 1       | 2,83           | 974,17         |
| 5001           | 14               | 25602          | 5,12                | 0,06        | 99,94     | 4743     | 1       | 2,76           | 4740,24        |
| 10001          | 15               | 51282          | 5,13                | 0,03        | 99,97     | 9482     | 1       | 2,80           | 9479,20        |
| 100001         | 25               | 547279         | 5,47                | 0,00        | 100,00    | 100921   | 1       | 4,63           | 100916,37      |

–ò —Å–æ—Å—Ç–∞–≤–∏–º –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç –æ–±—ä—ë–º–∞ —Ä–∞–±–æ—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Ç—Ä—ë—Ö —Ç–∏–ø–æ–≤ —Ä–∞–±–æ—Ç—ã: –ø—Ä–æ—Å—Ç–æ —Ü–∏–∫–ª, ThreadPool –∏ –Ω–µ–∫–∏–π –Ω–∞—à SmartThreadPool, —Ä–µ—á—å –æ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–π–¥—ë—Ç —á—É—Ç—å –ø–æ–∑–∂–µ:

![](./img/TasksSpreadInCpuTicks_big-compare.png)
 
–°—Ä–µ–≤–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ **–ª–∏–Ω–µ–π–Ω–æ–≥–æ** –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è  {.description}

![](./img/TasksSpreadInCpuTicks_big-compare-full.png)

–°—Ä–µ–≤–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Å —É—á—ë—Ç–æ–º –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞  {.description}

–ß—Ç–æ –º—ã —É–≤–∏–¥–∏–º? –ü–æ—Å–∫–æ–ª—å–∫—É –æ–±—ã—á–Ω—ã–π —Ü–∏–∫–ª –ø–æ—á—Ç–∏ –Ω–µ –∏–º–µ–µ—Ç –∏–∑–¥–µ—Ä–∂–µ–∫ (—Å–º —Ç–∞–±–ª), –≤–ø–ª–æ—Ç—å –¥–æ 500 - 600 –∏—Ç–µ—Ä–∞—Ü–∏–π –æ–Ω –æ–±–≥–æ–Ω—è–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ TheradPool –∏ SmartThreadPool. –û–¥–Ω–∞–∫–æ –ø–æ—Å–ª–µ - –≤–ø–µ—Ä—ë–¥ –≤—ã—Ä—ã–≤–∞–µ—Ç—Å—è SmartThreadPool, —É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π –ª–∏–¥–µ—Ä—Å—Ç–≤–æ –Ω–∞ –≤—Å—ë–º –æ—Å—Ç–∞—Ç–∫–µ –æ–±—ä–µ–º–æ–≤ —Ä–∞–±–æ—á–µ–≥–æ —Ü–∏–∫–ª–∞.

–ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –º—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∏–º–µ–Ω–Ω–æ ThreadPool`—ã –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±—ä–µ–º–∞—Ö –∑–∞–¥–∞—á. –ï—Å–ª–∏ –±—ã –Ω–∞–º –±—ã–ª–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ—à–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —ç—Ç—É –∑–∞–¥–∞—á—É, —ç—Ç–æ –Ω–µ –±—ã–ª–æ –±—ã 500_000 –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –≤ ThreadPool, –∞ —Å–∫–æ—Ä–µ–µ 12 –ø–æ—Ç–æ–∫–æ–≤ –ø–æ —Ü–∏–∫–ª—É –≤ 41666 –∏—Ç–µ—Ä–∞—Ü–∏–π, –Ω–æ –∑–∞—Ç–æ –º—ã –≤—ã—è—Å–Ω–∏–ª–∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω—É—é –≤–µ—â—å: –¥–∞–ª–µ–∫–æ –Ω–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å—Ç–æ–∏—Ç —Ä–µ—à–∞—Ç—å —á–µ—Ä–µ–∑ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤. –û—á–µ–Ω—å —á–∞—Å—Ç–æ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –∑–∞–º–µ–¥–ª–µ–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í—Ç–æ—Ä–æ–µ -- –µ—Å–ª–∏ —É–∂ —Ä–µ—à–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ ThreadPool, —Ç–æ –Ω–∞–¥–æ –ø–æ–º–Ω–∏—Ç—å –æ —Ç–æ–º, —á—Ç–æ –º–Ω–æ–≥–æ —Å–≤–æ—Ä–µ—Ö–∫–æ—Ä–æ—Ç–∫–∏—Ö –¥–µ–ª–µ–≥–∞—Ç–æ–≤ —Ç—É–¥–∞ –ª—É—á—à–µ –Ω–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å: —ç—Ç–æ –≤–æ–≤—Å–µ –Ω–µ —É—Å–∫–æ—Ä–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞, —Å–∫–æ—Ä–µ–µ, –∑–∞–º–µ–¥–∏—Ç.

–ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è? 

![](./img/TasksSpreadInCpuTicks_tp-destribution-zoom.png)

ThreadPool {.description}

![](./img/TasksSpreadInCpuTicks_stp-distribution.png)

SmartThreadPool {.description}

–ü–∏–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å –∏ —É—à–ª–∏ –≤ –ø–µ—Ä–≤—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω, –¥–∏–∞–ø–∞–∑–æ–Ω "–±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤", –∫–æ–≥–¥–∞ –Ω–µ—Ç –±–æ—Ä—å–±—ã –∑–∞ —Ä–µ—Å—É—Ä—Å. –í—Ç–æ—Ä–æ–π –ø–∏–∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏—Å—á–µ–∑, –∞ —Ç—Ä–µ—Ç–∏–π —Å—Ç–∞–ª —Å–∏–ª—å–Ω–æ –Ω–∏–∂–µ. –¢.–µ. –Ω–æ–≤—ã–π –ø—É–ª —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –æ–±–≥–æ–Ω—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π.

### –í–º–µ—Å—Ç–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è

–¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –æ—á–µ–Ω—å —á–∞—Å—Ç–æ —Ä–∞–±–æ—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ CPU-bound –∫–æ–¥–∞, –Ω–æ –∏ IO-bound –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è IO-bound –≥—Ä—É–ø–ø—ã –ø–æ—Ç–æ–∫–æ–≤ ThreadPool (–±–µ–∑ `ThreadPool.RegisterWaitForSingleObject`). –Ø –≥–æ–≤–æ—Ä—é –æ –¥–µ–ª–µ–≥–∞—Ç–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –≤ ThreadPool, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–º–æ—â–∏ `QueueUserWorkItem`. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –¥–µ–ª–µ–≥–∞—Ç—ã, –≤—ã–ø–æ–ª–Ω–∏–≤ —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –æ–∂–∏–¥–∞—é—Ç –æ—Ç –û–° —Å–∏–≥–Ω–∞–ª–∞, —Å–Ω—è—Ç–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–∂–∏–¥–∞–Ω–∏–µ–º –æ—Ç –¥–∏—Å–∫–æ–≤–æ–π –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞. –ò —Ç–µ–º —Å–∞–º—ã–º –ø—É—Å—Ç—å –∏ –Ω–µ –Ω–∞ –¥–æ–ª–≥–æ, –Ω–æ —Å–Ω–∏–∂–∞—é—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å ThreadPool —Å–Ω–∏–∑–∏–≤ –ø—Ä–∏ —ç—Ç–æ–º –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ).

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–æ–º–∏–º–æ –ø–æ—Ç–æ–∫–∞ –≤—ã –±–ª–æ–∫–∏—Ä—É–µ—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ThreadPool –ø–æ –±—ã—Å—Ç—Ä–æ–π –æ—Ç—Ä–∞–±–æ—Ç–∫–µ –¥–µ–ª–µ–≥–∞—Ç–æ–≤: ThreadPool —É–∂–µ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –≤—Å–µ 100%. –ò –ø–æ —Ñ–∞–∫—Ç—É —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π —Å–ª—É—á–∞–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ. –ú—ã —Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º Request, —Ç–æ –∂–¥—ë–º Response, —Ç–æ –µ—â—ë —á—Ç–æ. –ò –∏–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π ThreadPool –∏–º–µ–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É "–ø–æ –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –Ω–∞ —è–¥—Ä–æ". –í —Ö—É–¥—à–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ, –Ω–æ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–ª–µ–≥–∞—Ç–∞—Ö: –∫–æ–≥–¥–∞ –Ω–∞ ThreadPool —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ CPU-bound –∫–æ–¥ ThreadPool –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ—Ç –ø—Å–µ–≤–¥–æ–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ—Ç–æ–∫–∞–º–∏, –Ω–æ —Å —Ç–∞–∫–æ–π –∂–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é. –ù–æ –∫–æ–≥–¥–∞ –∫–∞–∫–∞—è-—Ç–æ –∏–∑ –∑–∞–¥–∞—á –≤—Å—Ç–∞–Ω–µ—Ç –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –∞ ThreadPool –∏–º–µ—è –≤—Ç–æ—Ä–æ–π –ø–æ—Ç–æ–∫ –Ω–∞ —Ç–æ–º –∂–µ —è–¥—Ä–µ, –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç —Ä–∞–±–æ—Ç—É –∏ —Å–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —É–∂–µ –Ω–µ 50% –æ—Ç –≤—Ä–µ–º–µ–Ω–∏, –∞ –≤—Å–µ 100%. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∏–º–µ—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ x2 –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è–¥–µ—Ä –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –Ω–∞–ª–∏—á–∏—è IO-bound –æ–ø–µ—Ä–∞—Ü–∏–π ThreadPool –∏—Ö –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –µ—â—ë –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä x3, —Ç–æ —ç—Ç–æ —É–∂–µ —Å–æ–∑–¥–∞—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã, —Ç.–∫. –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –∏–∑ —Ç—Ä—ë—Ö –Ω–∞ —è–¥—Ä–µ —É–π–¥—É—Ç –≤ IO-bound –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫—Ä–∞–π–Ω–µ –º–∞–ª–∞ –∏ –ø–æ—Ç–æ–º—É –≤ —ç—Ç–æ–º –Ω–µ—Ç —Å–º—ã—Å–ª–∞.

## –í—ã–≤–æ–¥—ã –ø–æ —Ä–∞–∑–¥–µ–ª—É 

- –ü–æ—Ç–æ–∫–∏ -- –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –æ –Ω–∏—Ö –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç;
- –ü–æ—Ç–æ–∫–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥—É, –∫–æ–≥–¥–∞ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—è—é—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–¥—Ä–∞—Ö, —Ç–∞–∫ –∏ –ø—Å–µ–≤–¥–æ–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –∫–æ–≥–¥–∞ –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ –æ–Ω–∏ —á–µ—Ä–µ–∑–¥—É—é—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ —á—Ç–æ–±—ã –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è —ç—Ç–æ –≤—ã–≥–ª—è–¥–µ–ª–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π;
- –ê –ø–æ—Ç–æ–º—É –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç, –¥–∞–∂–µ –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ `x = y`;
- –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö –º–æ–∂–Ω–æ, –Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ —É –≤–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–Ω–æ–≥–æ —Ä–∞–±–æ—Ç—ã, —Ç.–∫. —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ —Å–∞–º–∞ –ø–æ —Å–µ–±–µ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è;
- –ò–Ω–∞—á–µ –≤–ø–æ–ª–Ω–µ –ª–æ–≥–∏—á–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è ThreadPool'–æ–º: –æ–Ω –¥–ª—è —Ç–æ–≥–æ –∏ —Å–æ–∑–¥–∞–Ω —á—Ç–æ–±—ã —á–µ—Ä–µ–∑ —Å–µ–±—è –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ä—è–¥ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –∑–∞–¥–∞—á *–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏* —Ä–µ–≥—É–ª–∏—Ä—É—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞;
- –°—É—â–µ—Å—Ç–≤—É—é—Ç IO-bound –∏ CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–∏. –ü–µ—Ä–≤—ã–µ -- –Ω–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏, –≤—Ç–æ—Ä—ã–µ -- –Ω–∞ –ø—Ä–æ–æ—Ü–µ—Å—Å–æ—Ä–µ. –ü–æ–∫–∞ –∏–¥—ë—Ç IO-bound –æ–ø–µ—Ä–∞—Ü–∏—è, –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –≤—Å—Ç–∞—Ç—å –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É;
- –î–ª—è CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π —É –ø—É–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ —Å–≤–æ–∏ –º–µ—Ç–æ–¥—ã, –¥–ª—è IO-bound -- —Å–≤–æ–∏;
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Ç–æ–∫–∞ -- —ç—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –µ–≥–æ –∏–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –∑–Ω–∞—á–∏—Ç –ø–æ—Ç–æ–∫ –≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è;
- –í–æ –≤—Ä–µ–º—è —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Ç—Ä–∞—Ç–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–π —Ä–µ—Å—É—Ä—Å –Ω–∞ —Å–≤–æ–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã;
- –ê –∑–Ω–∞—á–∏—Ç –µ—Å—Ç—å –≥—Ä–∞–Ω—å, –∫–∞–∫—É—é —Ä–∞–±–æ—Ç—É –≤—ã–≥–æ–¥–Ω–æ –∏—Å–ø–æ–ª–Ω–∏—Ç—å –ª–∏–Ω–µ–π–Ω–æ, –∞ –∫–∞–∫—É—é - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —á–µ—Ä–µ–∑ –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤;
- –¶–µ–Ω–∞ —ç—Ç–∞ - 500 –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–≤—É—Ö —á–∏—Å–µ–ª –∏–ª–∏ 3000 —Ç–∞–∫—Ç–æ–≤. –°—á–∏—Ç–∞—Ç—å —Å–ª–æ–∂–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ :)